{"pages":[],"posts":[{"title":"ReactNativeé›†æˆTypeScript","text":"åˆå§‹åŒ–é¡¹ç›®çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨TypeScriptï¼Œä¹‹åé›†æˆTSçš„ç¬”è®° å®‰è£…npm i --dev typescript react-native-typescript-transformer åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶rn-cli.config.js 12345678module.exports = { getTransformModulePath() { return require.resolve(&apos;react-native-typescript-transformer&apos;) }, getSourceExts() { return [&apos;ts&apos;, &apos;tsx&apos;]; }} åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶tsconfig.json 123456789{ &quot;compilerOptions&quot;: { &quot;target&quot;: &quot;es2015&quot;, &quot;module&quot;: &quot;es2015&quot;, &quot;jsx&quot;: &quot;react-native&quot;, &quot;moduleResolution&quot;: &quot;node&quot;, &quot;allowSyntheticDefaultImports&quot;: true }} ä¿®æ”¹App.jså’Œ__tests__/App.jsæ–‡ä»¶åä¸ºApp.tsxï¼Œå¹¶ä¸”ä¿®æ”¹æ–‡ä»¶ç¬¬ä¸€è¡Œçš„å¼•å…¥ï¼š 12345// å°†ï¼š-import React, { Component } from &apos;react&apos;;// ä¿®æ”¹ä¸ºï¼š+import React from &apos;react&apos;+import { Component } from &apos;react&apos;; æ·»åŠ ç±»å‹å£°æ˜ä¾èµ–npm i --dev @types/react @types/react-native è‡³æ­¤ï¼Œç»“æŸï¼","link":"/2019/06/26/ReactNativeé›†æˆTypeScript/"},{"title":"å†™ç»™è‡ªå·±çœ‹çš„Reactç¬”è®°","text":"ä¸€äº›ReactçŸ¥è¯†ç‚¹çš„æ€»ç»“ã€‚ ä¿®æ”¹objectä¸­æŸé¡¹123this.setState({object: {...object, key: value}}) ç»„ä»¶é€šä¿¡çˆ¶ç»„ä»¶ =&gt; å­ç»„ä»¶ï¼šthis.refs[â€˜å­ç»„ä»¶refçš„åå­—â€™].add();å­ç»„ä»¶ =&gt; çˆ¶ç»„ä»¶ï¼šåœ¨çˆ¶ç»„ä»¶è°ƒç”¨çš„å­ç»„ä»¶ä¸ŠåŠ ä¸Špropsåç§°xxxï¼Œç±»ä¼¼vueä¸­çš„ emitï¼Œç„¶åå­ç»„ä»¶é€šè¿‡this.props.xxx.add() éå†æ‰€æœ‰å­èŠ‚ç‚¹ä½¿ç”¨React.childrenæ¥å¤„ç†this.props.childrenï¼Œå› ä¸ºthis.props.childrenå¯èƒ½æœ‰ä¸‰ç§ç±»å‹ï¼Œundefined, object, arrayï¼Œä½¿ç”¨React.childrenå¯ä»¥ä¸ç”¨æ‹…å¿ƒæ­¤é—®é¢˜ã€‚ 123456789101112131415161718192021var NotesList = React.createClass({ render: function() { return ( &lt;ol&gt; { React.Children.map(this.props.children, function (child) { return &lt;li&gt;{child}&lt;/li&gt;; }) } &lt;/ol&gt; ); }});ReactDOM.render( &lt;NotesList&gt; &lt;span&gt;hello&lt;/span&gt; &lt;span&gt;world&lt;/span&gt; &lt;/NotesList&gt;, document.body); propséªŒè¯ï¼ˆä½¿ç”¨PropTypesï¼‰1234567891011var MyTitle = React.createClass({ propTypes: { // è¡¨ç¤ºå¿…è¦å±æ€§ï¼Œå¹¶ä¸”æ˜¯stringç±»å‹ title: React.PropTypes.string.isRequired, }, render: function() { return &lt;h1&gt; {this.props.title} &lt;/h1&gt;; }}); è®¾ç½®é»˜è®¤propsï¼ˆä½¿ç”¨getDefaultPropsï¼‰12345678910111213var MyTitle = React.createClass({ getDefaultProps : function () { return { // å¦‚æœæ²¡æœ‰ä¼ å…¥title propsï¼Œé‚£ä¹ˆé»˜è®¤å€¼ä¸ºâ€˜Hello Worldâ€™ title : &apos;Hello World&apos; }; }, render: function() { return &lt;h1&gt; {this.props.title} &lt;/h1&gt;; }}); è·å–è¡¨å•çš„è¾“å…¥å†…å®¹è¡¨å•ç»„ä»¶Input, Textarea, Select, Radioç­‰ï¼Œå¿…é¡»æ·»åŠ ä¸€ä¸ªæ–¹æ³•æ¥è·å–å…¶ä¸­çš„å†…å®¹ï¼ˆevent.target.valueï¼‰ 12345&lt;input type=&quot;text&quot; value={value} onChange={this.handleChange} /&gt;handleChange: function(event) { this.setState({value: event.target.value});} ç”Ÿå‘½å‘¨æœŸæ›´æ–°é¡µé¢çš„3ä¸ªç”Ÿå‘½å‘¨æœŸï¼šcompomentDidMount, compomentWillReceiveProps, shouldCompomentUpdate TipsJSXä¸­renderå¯¹è±¡ä¸èƒ½ç”¨async","link":"/2019/06/25/å†™ç»™è‡ªå·±çœ‹çš„Reactç¬”è®°/"},{"title":"react-native-file-selectorå®‰è£…é‡åˆ°çš„é—®é¢˜","text":"åœ¨å®‰è£…react-native-file-selectoræ—¶é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œç‰¹æ­¤è®°å½• å®‰è£…npm install react-native-file-selector --saveä¹‹åï¼Œåƒä¸‡ä¸è¦linkï¼Œä¸ç„¶ä¼šå‡ºé”™ï¼ åœ¨android\\settings.gradleæ·»åŠ  12include ':react-native-file-selector'project(':react-native-file-selector').projectDir = new File(rootProject.projectDir, '../node_modules/react-native-file-selector/android') åœ¨android\\build.gradleæ·»åŠ  1maven { url \"http://dl.bintray.com/lukaville/maven\" } åœ¨android\\app\\build.gradleä¸­æ·»åŠ  1implementation project(':react-native-file-selector') åœ¨MainApplication.javaä¸­å¼•ç”¨jaråŒ… 1import ui.fileselector.RNFileSelectorPackage; åœ¨ä¸‹é¢çš„getPackages()ä¸­ä½¿ç”¨ 1new RNFileSelectorPackage(), æ–°å¢ä¸»é¢˜æ–‡ä»¶android/app/src/main/res/values/colors.xmlï¼Œå¯ä»¥è‡ªå®šä¹‰ 12345 &lt;resources&gt; &lt;color name=\"colorPrimary\"&gt;#3F51B5&lt;/color&gt; &lt;color name=\"colorPrimaryDark\"&gt;#303F9F&lt;/color&gt; &lt;color name=\"colorAccent\"&gt;#FF4081&lt;/color&gt;&lt;/resources&gt; åœ¨android\\app\\src\\main\\AndroidManifest.xmlæ·»åŠ æƒé™ 1&lt;uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" /&gt; åˆ°è¿™é‡Œç®—æ˜¯å®Œæˆäº†è‡ªåŠ¨linkçš„æ­¥éª¤ï¼Œä½†æ˜¯è¿˜æœ‰bugï¼ï¼ï¼é”™è¯¯æç¤ºï¼š 1Android dependency 'com.android.support:support-v4' has different version for the compile (27.0.2) and runtime (28.0.0) classpath. You should manually set the same version via DependencyResolution è§£å†³åŠæ³•ï¼Œä¿®æ”¹æˆ‘ä»¬ç¬¬4æ­¥ä¸ºï¼š 123implementation (project(':react-native-file-selector')) { exclude group: 'com.android.support' } è‡³æ­¤ï¼Œç»“æŸï¼","link":"/2019/06/24/react-native-file-selectorå®‰è£…é‡åˆ°çš„é—®é¢˜/"},{"title":"å¦‚ä½•åœ¨å¾ªç¯ä¸­ä½¿ç”¨await","text":"æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨å¾ªç¯ä¸­ç­‰å¾…ä¸Šä¸€æ¬¡ç»“æŸå†è¿›è¡Œä¸‹ä¸€æ¬¡çš„æ“ä½œï¼Œå¦‚æœç›´æ¥åœ¨forEachä½¿ç”¨awaitæ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼Œå› ä¸ºforEach åªæ˜¯ç®€å•çš„æ‰§è¡Œäº†ä¸‹å›è°ƒå‡½æ•°è€Œå·²ï¼Œå¹¶ä¸ä¼šå»å¤„ç†å¼‚æ­¥çš„æƒ…å†µã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨forå¾ªç¯æ¥å®ç°æƒ³è¦çš„æ•ˆæœã€‚ for12345678910111213141516171819async function fn() { let arr = [1,2,3]; console.log('start') for (const item of arr) { const res = await fetch(item) console.log(res) } console.log('end')}function fetch(i) { return new Promise ((resolve, reject) =&gt; { setTimeout(() =&gt; { resolve(i) }, 500 * i); })}fn(); for of12345678910111213141516171819async function fn() { let arr = [1,2,3] console.log('start') for (let item of arr) { const res = await fetch(item) console.log(res) } console.log('end')}function fetch(i) { return new Promise((resolve, reject) =&gt; { setTimeout(() =&gt; { resolve(i) }, 500 * i); })}fn(); æ€ä¹ˆè®©forEachæ”¯æŒawaitforEachç®€å•çš„åŸç†å°±æ˜¯ï¼š 123while (index &lt; arr.length) { callback(item, index) //ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å›è°ƒå‡½æ•°} æ„é€ ä¸€ä¸ªæ”¯æŒawaitçš„forEachï¼š 1234567891011121314151617Array.prototype.myforeach = async function (fn, context = null) { let index = 0; let arr = this; if (typeof fn !== 'function') { throw new TypeError(fn + ' is not a function'); } while (index &lt; arr.length) { if (index in arr) { try { await fn.call(context, arr[index], index, arr); } catch (e) { console.log(e); } } index ++; }};","link":"/2019/07/01/å¦‚ä½•åœ¨å¾ªç¯ä¸­ä½¿ç”¨await/"},{"title":"ReactNativeåŸç”Ÿç»„ä»¶FlatListå®ç°ä¸Šæ‹‰åŠ è½½","text":"æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®˜æ–¹ç»„ä»¶RefreshControlå®ç°ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½ï¼Œä½†å®˜æ–¹å¹¶æ²¡æœ‰æä¾›ç›¸åº”çš„ä¸Šæ‹‰åŠ è½½ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡è‡ªå·±æ‰‹åŠ¨å®ç°ã€‚ è¿™é‡Œç”¨åˆ°äº†FlatListç»„å»ºçš„onEndReachedä¸onEndReachedThresholdå±æ€§æ¥å®ç°ç›¸åº”æ•ˆæœã€‚ ä¸Šæ‹‰åŠ è½½æ€è·¯ä¸Šæ‹‰åŠ è½½ä¸€èˆ¬åº”ç”¨äºåˆ†é¡µåŠ è½½çš„æƒ…å†µï¼Œå½“FlatListæ»‘åŠ¨åˆ°åº•éƒ¨æ—¶ï¼š é¡µé¢pageIndexæ•°åŠ 1ï¼Œè§¦å‘è¯·æ±‚æ–°ä¸€é¡µçš„æ•°æ® æ›´æ–°åˆ°ç»„ä»¶stateä¸­çš„æ•°æ®æºdataArrayä¸­ï¼ŒdataArrayä¹Ÿä½œä¸ºFlatListçš„æ•°æ®æºdata æ»‘åŠ¨åˆ°åº•éƒ¨è§¦å‘è¯·æ±‚æ–°ä¸€é¡µçš„æ•°æ®é€šè¿‡FlatListçš„onEndReachedå’ŒonEndReachedThresholdå±æ€§æ¥å®ç° å…·ä½“å®ç°onEndReachedä¸Šæ‹‰åŠ è½½çš„å…³é”®æ˜¯onEndReachedï¼Œé€šè¿‡è®¾ç½®è·ç¦»åº•éƒ¨è·ç¦»onEndReachedThresholdçš„å€¼ï¼ˆå€¼ä¸ºæ¯”ä¾‹ï¼Œ0.5è¡¨ç¤ºè·ç¦»åº•éƒ¨ä¸€åŠï¼‰ï¼Œæ¥è§¦å‘onEndReachedäº‹ä»¶ã€‚ onEndReachedæ–¹æ³•åœ¨å½“åˆ—è¡¨è¢«æ»šåŠ¨åˆ°è·ç¦»æœ€åº•éƒ¨å°äºonEndReachedThresholdçš„å€¼æ—¶è°ƒç”¨ã€‚ 12345678910111213141516171819/** * ä¸Šæ‹‰åŠ è½½ */_onEndReached = () =&gt; { /** å¦‚æœæ˜¯æ­£åœ¨åŠ è½½ä¸­æˆ–æ²¡æœ‰æ›´å¤šæ•°æ®äº†ï¼Œåˆ™è¿”å› */ if (this.state.showFoot !== 0 ) return; /** å¦‚æœå½“å‰é¡µå¤§äºæˆ–ç­‰äºæ€»é¡µæ•°ï¼Œé‚£å°±æ˜¯åˆ°æœ€åä¸€é¡µäº†ï¼Œè¿”å› */ if ((this.state.pageIndex !== 1) &amp;&amp; (this.state.showFoot === 1)) { return; } else { this.setState({pageIndex: this.state.pageIndex + 1}); } /** åº•éƒ¨æ˜¾ç¤ºæ­£åœ¨åŠ è½½æ›´å¤šæ•°æ® */ this.setState({showFoot: 2}); /** è·å–æ•°æ® */ this._fetchPrev();} åˆå§‹State123456789101112131415161718192021222324constructor(props) { super(props); this.state = { isLoading: true, // ç½‘ç»œè¯·æ±‚å¤±è´¥ fetchError: false, errorInfo: \"\", // åˆ—è¡¨æ•°æ® dataArray: [], /** * æ˜¯å¦æ˜¾ç¤ºåº•éƒ¨ç»„ä»¶ * 0ï¼šéšè—footer * 1ï¼šå·²åŠ è½½å®Œæˆ,æ²¡æœ‰æ›´å¤šæ•°æ® * 2ï¼šæ˜¾ç¤ºåŠ è½½ä¸­ */ showFoot:0, // ä¸‹æ‹‰åˆ·æ–°æ§åˆ¶ isRefreshing:false, // å½“å‰é¡µç  pageIndex: 1, // æ¯é¡µä¸ªæ•° pageSize: 10, }} æ•°æ®è·å–è·å–åˆ°æ–°ä¸€é¡µçš„æ•°æ®æ—¶ï¼ŒæŠŠpageIndexåŠ 1ï¼Œ å½“è·å–åˆ°æ•°æ®dataæ—¶ï¼Œæ‹¼æ¥åœ¨å·²æœ‰çš„dataArrayä¸Šï¼š 123456789101112componentDidMount() { //è¯·æ±‚æ•°æ® this.fetchData();}this.setState({ //å¤åˆ¶æ•°æ®æº dataArray:this.state.dataArray.concat(data), isLoading: false, showFoot:foot, isRefreshing:false,}); ç»„ä»¶æ¸²æŸ“1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950/** * åŠ è½½ç­‰å¾…é¡µ */_renderLoadingView = () =&gt; { return ( &lt;ActivityIndicator animating={this.state.isLoading} toast={true} color='#108ee9' size=\"large\" /&gt; );}/** * åŠ è½½å¤±è´¥é¡µ */_renderErrorView = () =&gt; { return ( &lt;View style={styles.fetchErrContainer}&gt; &lt;Text&gt;ç½‘ç»œè¯·æ±‚å¤±è´¥&lt;/Text&gt; &lt;/View&gt; );}render() { // ç¬¬ä¸€æ¬¡åŠ è½½ç­‰å¾…çš„view if (this.state.isLoading &amp;&amp; !this.state.error) { // åŠ è½½ç­‰å¾…é¡µ return this.renderLoadingView(); } else if (this.state.error) { // ç½‘ç»œè¯·æ±‚å¤±è´¥ return this.renderErrorView(); } // åˆ—è¡¨ return ( &lt;FlatList data={this.state.dataArray} keyExtractor={(item, index) =&gt; `${item.id} - ${index}`} renderItem={this._renderItem} ListFooterComponent={this._renderFooter} onEndReached={this._onEndReached} onEndReachedThreshold={0.5} refreshing={this.state.refreshing} onRefresh={this._onRefresh} ItemSeparatorComponent={this._renderSeparator} /&gt; )} æ¯ä¸ªItemç»„ä»¶renderItemæ ¹æ®è¡Œæ•°æ®dataArrayæ¥æ¸²æŸ“æ¯ä¸ªItemç»„ä»¶ 123456789101112_renderItem = ({ item, index, separator }) =&gt; { return ( &lt;View&gt; &lt;Text style={styles.title}&gt; name: {item.value.name} ({item.value.stargazers_count}stars) &lt;/Text&gt; &lt;Text style={styles.content}&gt; description: {item.value.description} &lt;/Text&gt; &lt;/View&gt; );} åº•éƒ¨ä¸Šæ‹‰åŠ è½½loadingç»„ä»¶ListFooterComponentä¸ºå°¾éƒ¨ç»„ä»¶çš„æ¸²æŸ“ 123456789101112131415161718192021222324252627/** * åº•éƒ¨æç¤ºç»„ä»¶ */_renderFooter = () =&gt; { if (this.state.showFoot === 1) { return ( &lt;View&gt; &lt;Text style={{color: '#aaa', fontSize: 14, textAlign: 'center', height: 80, marginBottom: 10}}&gt; æ²¡æœ‰æ›´å¤šæ•°æ®äº† &lt;/Text&gt; &lt;/View&gt; ); } else if (this.state.showFoot === 2) { return ( &lt;View style={{flexDirection: 'row', justifyContent: 'center', alignItems: 'center', height: 80, marginBottom: 10}}&gt; &lt;ActivityIndicator /&gt; &lt;Text&gt;æ­£åœ¨åŠ è½½æ›´å¤šæ•°æ®...&lt;/Text&gt; &lt;/View&gt; ); } else if (this.state.showFoot === 0) { return ( &lt;View&gt; &lt;Text&gt;&lt;/Text&gt; &lt;/View&gt; ); }} æ¯ä¸ªItemä¹‹é—´çš„åˆ†éš”çº¿ItemSeparatorComponentæ˜¯è¡Œä¸è¡Œä¹‹é—´çš„åˆ†éš”çº¿ç»„ä»¶,ä¸ä¼šå‡ºç°åœ¨ç¬¬ä¸€è¡Œä¹‹å‰å’Œæœ€åä¸€è¡Œä¹‹å 12345_renderSeparator(){ return( &lt;View style={{height:1,backgroundColor:'#999999'}}/&gt; )} ActivityIndicatoråŠ è½½æŒ‡ç¤ºå™¨ç”¨åŸç”Ÿç»„ä»¶ActivityIndicatoræ¥å®ç°Loadingçš„æ•ˆæœã€‚ 1234567&lt;ActivityIndicator // { string } æ˜¯å¦æ˜¾ç¤º animating={true} color='red' // enum('small', 'large') size=\"large\"/&gt;","link":"/2019/07/03/ReactNativeåŸç”Ÿç»„ä»¶FlatListå®ç°ä¸Šæ‹‰åŠ è½½/"},{"title":"ReactNativeåº”ç”¨åç§°åŠå›¾æ ‡ä¿®æ”¹","text":"APPåç§°å’Œå›¾æ ‡çš„ä¿®æ”¹æ–¹æ³•ã€‚ ä¿®æ”¹APPåç§° åœ¨android/app/src/main/AndroidManifest.xmlé‡Œï¼Œæ‰¾åˆ°android:label=&quot;@string/app_name&quot;ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äºå®šä¹‰å¥½çš„å˜é‡ï¼Œå®ƒè°ƒç”¨çš„åœ°æ–¹åœ¨android\\app\\src\\main\\AndroidManifest.xmlé‡Œã€‚ ä¿®æ”¹android/app/src/main/res/valuse/strings.xmlä¸­çš„æ–‡æœ¬ï¼Œå°±ä¼šæ”¹å˜APPåœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºçš„åç§° 123&lt;resources&gt; &lt;string name=\"app_name\"&gt;å·¡æ£€ç³»ç»Ÿ&lt;/string&gt;&lt;/resources&gt; ä¿®æ”¹APPå›¾æ ‡ è¿›å…¥ç›®å½•android/app/src/main/AndroidManifest.xmlï¼Œæ‰¾åˆ°android:icon=&quot;@mipmap/ic_launcher&quot;ï¼Œå®ƒè°ƒç”¨çš„åœ°æ–¹åœ¨android\\app\\src\\main\\res\\mipmap-XXXé‡Œã€‚ æ›¿æ¢å‡ ä¸ªmipmap-XXXç›®å½•ä¸­çš„pngå›¾ç‰‡å³å¯ï¼Œåˆ†åˆ«å¯¹åº”çš„åˆ†è¾¨ç‡ä¸ºï¼š48x48ï¼Œ72x72ï¼Œ96x96ï¼Œ144x144ï¼Œ192x192ã€‚ å¦‚æœä½ AndroidManifest.xmlæ–‡ä»¶é‡Œæ˜¯android:icon=&quot;@drawable/ic_launcher&quot;ï¼Œé‚£ä¹ˆä¿®æ”¹drawable-XXXæ–‡ä»¶å›¾ç‰‡å³å¯ã€‚","link":"/2019/07/04/ReactNativeåº”ç”¨åç§°åŠå›¾æ ‡ä¿®æ”¹/"},{"title":"å†™ç»™è‡ªå·±çœ‹çš„react-native-pushyä½¿ç”¨ç¬”è®°","text":"æœ¬æ–‡æ˜¯æ ¹æ®react-native-pushyæ–‡æ¡£ï¼Œä½¿ç”¨åçš„ä¸€äº›ç¬”è®°æ•´ç†ã€‚ æ‰‹æœºç³»ç»Ÿï¼šAndroid ç¯å¢ƒé…ç½®ç¯å¢ƒé…ç½® ç¯å¢ƒï¼šReact Native ç‰ˆæœ¬0.58ï¼Œreact-native-update ç‰ˆæœ¬5.1.8 å®‰è£…123npm i -g react-native-update-clinpm i react-native-updatereact-native link react-native-update ç„¶ååœ¨ç›®å½•android\\app\\src\\main\\java\\app\\ytd\\dg\\MainApplication.javaä¸­ï¼Œæ·»åŠ ä»£ç ï¼š12345678910111213141516// ... å…¶å®ƒä»£ç // æ·»åŠ è¿™ä¸ªimportimport cn.reactnative.modules.update.UpdateContext;public class MainApplication extends Application implements ReactApplication { private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) { // æ·»åŠ ä¸‹é¢è¿™æ®µ @Override protected String getJSBundleFile() { return UpdateContext.getBundleUrl(MainApplication.this); } // ... å…¶å®ƒä»£ç  }} é…ç½®åœ¨reactnativeåˆ›å»ºä¸€ä¸ªè´¦å·ã€‚ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œï¼š123pushy loginemail: &lt;è¾“å…¥ä½ çš„æ³¨å†Œé‚®ç®±&gt;password: &lt;è¾“å…¥ä½ çš„å¯†ç &gt; è¿™ä¼šåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª.updateæ–‡ä»¶ï¼Œæ³¨æ„ä¸è¦æŠŠè¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°Gitç­‰CVSç³»ç»Ÿä¸Šã€‚ä½ å¯ä»¥åœ¨.gitignoreæœ«å°¾å¢åŠ ä¸€è¡Œ.updateæ¥å¿½ç•¥è¿™ä¸ªæ–‡ä»¶ã€‚ ç„¶ååˆ›å»ºä¸€ä¸ªæˆ‘ä»¬çš„åº”ç”¨ï¼ˆä¹Ÿå¯ä»¥åœ¨ç½‘é¡µä¸Šåˆ›å»ºï¼‰ï¼š12pushy createApp --platform androidApp Name: &lt;è¾“å…¥åº”ç”¨åå­—&gt; å¦‚æœæ˜¯åœ¨ç½‘é¡µä¸Šåˆ›å»ºçš„ï¼Œå°±æ‰§è¡Œé€‰æ‹©APPçš„å‘½ä»¤ï¼š123456pushy selectApp --platform android15121) App Name 135567) App Name 2Total 2 android appsEnter appId: &lt;è¾“å…¥)å‰é¢çš„ç¼–å·&gt; æ‰§è¡Œå®Œä¸Šé¢çš„åˆ›å»ºæˆ–è€…é€‰æ‹©APPçš„æ“ä½œä»¥åï¼Œä½ å¯ä»¥åœ¨æ ¹ç›®å½•çœ‹åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶update.jsonï¼Œå®ƒä¸åŒ…å«ä»»ä½•æ•æ„Ÿä¿¡æ¯ã€‚ æ·»åŠ çƒ­æ›´æ–°åŠŸèƒ½æ·»åŠ çƒ­æ›´æ–°åŠŸèƒ½å®Œæ•´ä»£ç ç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108import React, { Component,} from 'react';import { StyleSheet, Platform, Text, View, Alert, TouchableOpacity, Linking,} from 'react-native';import { isFirstTime, isRolledBack, packageVersion, currentVersion, checkUpdate, downloadUpdate, switchVersion, switchVersionLater, markSuccess,} from 'react-native-update';import _updateConfig from './update.json';const {appKey} = _updateConfig[Platform.OS];class MyProject extends Component { componentWillMount(){ if (isFirstTime) { Alert.alert('æç¤º', 'è¿™æ˜¯å½“å‰ç‰ˆæœ¬ç¬¬ä¸€æ¬¡å¯åŠ¨,æ˜¯å¦è¦æ¨¡æ‹Ÿå¯åŠ¨å¤±è´¥?å¤±è´¥å°†å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬', [ {text: 'æ˜¯', onPress: ()=&gt;{throw new Error('æ¨¡æ‹Ÿå¯åŠ¨å¤±è´¥,è¯·é‡å¯åº”ç”¨')}}, {text: 'å¦', onPress: ()=&gt;{markSuccess()}}, ]); } else if (isRolledBack) { Alert.alert('æç¤º', 'åˆšåˆšæ›´æ–°å¤±è´¥äº†,ç‰ˆæœ¬è¢«å›æ»š.'); } } doUpdate = info =&gt; { downloadUpdate(info).then(hash =&gt; { Alert.alert('æç¤º', 'ä¸‹è½½å®Œæ¯•,æ˜¯å¦é‡å¯åº”ç”¨?', [ {text: 'æ˜¯', onPress: ()=&gt;{switchVersion(hash);}}, {text: 'å¦',}, {text: 'ä¸‹æ¬¡å¯åŠ¨æ—¶', onPress: ()=&gt;{switchVersionLater(hash);}}, ]); }).catch(err =&gt; { Alert.alert('æç¤º', 'æ›´æ–°å¤±è´¥.'); }); }; checkUpdate = () =&gt; { checkUpdate(appKey).then(info =&gt; { if (info.expired) { Alert.alert('æç¤º', 'æ‚¨çš„åº”ç”¨ç‰ˆæœ¬å·²æ›´æ–°,è¯·å‰å¾€åº”ç”¨å•†åº—ä¸‹è½½æ–°çš„ç‰ˆæœ¬', [ {text: 'ç¡®å®š', onPress: ()=&gt;{info.downloadUrl &amp;&amp; Linking.openURL(info.downloadUrl)}}, ]); } else if (info.upToDate) { Alert.alert('æç¤º', 'æ‚¨çš„åº”ç”¨ç‰ˆæœ¬å·²æ˜¯æœ€æ–°.'); } else { Alert.alert('æç¤º', 'æ£€æŸ¥åˆ°æ–°çš„ç‰ˆæœ¬'+info.name+',æ˜¯å¦ä¸‹è½½?\\n'+ info.description, [ {text: 'æ˜¯', onPress: ()=&gt;{this.doUpdate(info)}}, {text: 'å¦',}, ]); } }).catch(err =&gt; { Alert.alert('æç¤º', 'æ›´æ–°å¤±è´¥.'); }); }; render() { return ( &lt;View style={styles.container}&gt; &lt;Text style={styles.welcome}&gt; æ¬¢è¿ä½¿ç”¨çƒ­æ›´æ–°æœåŠ¡ &lt;/Text&gt; &lt;Text style={styles.instructions}&gt; è¿™æ˜¯ç‰ˆæœ¬ä¸€ {'\\n'} å½“å‰åŒ…ç‰ˆæœ¬å·: {packageVersion}{'\\n'} å½“å‰ç‰ˆæœ¬Hash: {currentVersion||'(ç©º)'}{'\\n'} &lt;/Text&gt; &lt;TouchableOpacity onPress={this.checkUpdate}&gt; &lt;Text style={styles.instructions}&gt; ç‚¹å‡»è¿™é‡Œæ£€æŸ¥æ›´æ–° &lt;/Text&gt; &lt;/TouchableOpacity&gt; &lt;/View&gt; ); }}const styles = StyleSheet.create({ container: { flex: 1, justifyContent: 'center', alignItems: 'center', backgroundColor: '#F5FCFF', }, welcome: { fontSize: 20, textAlign: 'center', margin: 10, }, instructions: { textAlign: 'center', color: '#333333', marginBottom: 5, },}); å‘å¸ƒå®‰å“åº”ç”¨å‘å¸ƒå®‰å“åº”ç”¨ è¿™é‡Œå‘å¸ƒçš„åŒ…æ–‡ä»¶ï¼Œæ˜¯ä¸Šä¼ åˆ°åº”ç”¨å•†åº—çš„åŸºç¡€ç‰ˆæœ¬ï¼Œæ— æ³•é€šè¿‡çƒ­æ›´æ–°æ¥è·å¾— 123456789101112// 1. è¿›å…¥androidç›®å½•`cd android`// 2. ç”ŸæˆAPK`./gradlew assembleRelease`// 3. è¿”å›æ ¹ç›®å½•`cd ..`// 4. å°†ç”Ÿæˆçš„APKå‘å¸ƒåˆ°PushyæœåŠ¡å™¨ä¸Š`pushy uploadApk android/app/build/outputs/apk/release/app-release.apk` å‘å¸ƒæ–°çš„çƒ­æ›´æ–°ç‰ˆæœ¬å‘å¸ƒæ–°çš„çƒ­æ›´æ–°ç‰ˆæœ¬ è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ ä¿®æ”¹ä½ çš„ä¸šåŠ¡ä»£ç  pushy bundle --platform android, ä¹‹åè¾“å…¥Yç«‹å³å‘å¸ƒï¼ˆæ­¤è¿‡ç¨‹æ˜¯ç”Ÿæˆæ–°çš„çƒ­æ›´æ–°ç‰ˆæœ¬ï¼‰ 123version name çƒ­æ›´æ–°ç‰ˆæœ¬å·, è¯·éµå¾ªç‰ˆæœ¬è§„èŒƒdescription, æè¿°æ›´æ–°å†…å®¹ï¼Œä¼šå±•ç¤ºç»™ç”¨æˆ·ï¼Œä¸æ”¯æŒ`\\n`æ¢è¡Œmeta info, ä¼ è¾“çš„å…ƒä¿¡æ¯ï¼Œä¾‹å¦‚`{'ok': 1}`ï¼ˆJSONçš„keyå¿…é¡»å¸¦å¼•å·ï¼‰ æ­¤æ—¶ç‰ˆæœ¬å·²ç»æäº¤åˆ°updateæœåŠ¡ï¼Œä½†ç”¨æˆ·æš‚æ—¶çœ‹ä¸åˆ°æ­¤æ›´æ–°ï¼Œä½ è¿˜éœ€è¦å°†æ­¤æ­¤çƒ­æ›´æ–°ç‰ˆæœ¬ç»‘å®šåˆ°æŒ‡å®šçš„åŒ…ç‰ˆæœ¬ä¸Šã€‚æœ‰3ç§æ–¹æ³•ï¼š è¾“å…¥Yç«‹å³ç»‘å®š æˆ–è€…ä»¥åpushy update --platform androidæ¥è®©å¯¹åº”åŒ…ç‰ˆæœ¬ç”¨æˆ·å¾—ä»¥æ›´æ–° è¾“å…¥Yæˆ–è€…ä¸Šè¿°å‘½ä»¤ä»¥åï¼Œä¼šè®©ä½ å†è¾“å…¥çƒ­æ›´æ–°ç‰ˆæœ¬å·versionIdï¼Œå°±æ˜¯)å‰é¢çš„æ•°å­— ï¼ˆå¯ä»¥ä½¿ç”¨Uä¸Šä¸€é¡µï¼ŒDä¸‹ä¸€é¡µï¼ŒBå›åˆ°å¼€å§‹ï¼‰ è¾“å…¥å®ŒversionIdä»¥åï¼Œä¼šè®©ä½ è¾“å…¥åŒ…ç‰ˆæœ¬å·packageIdï¼Œå°±æ˜¯U/D/Bæç¤ºä¸‹é¢çš„åˆ—è¡¨å‰çš„æ•°å­— è¿˜å¯ä»¥ç›´æ¥åœ¨ç½‘é¡µç«¯æ‹–æ‹½æ“ä½œ","link":"/2019/06/21/å†™ç»™è‡ªå·±çœ‹çš„react-native-pushyä½¿ç”¨ç¬”è®°/"},{"title":"ReactNativeåº”ç”¨åŒ…åä¿®æ”¹","text":"åŒ…åæ˜¯Androidå”¯ä¸€çš„åº”ç”¨IDã€‚ ä¿®æ”¹åŒ…ååï¼Œä¹‹å‰ä¸Šä¼ åˆ°åº”ç”¨å•†åº—çš„APPä¹Ÿå°±ä¸æ˜¯åŒä¸€æ¬¾äº†ã€‚ å‡è®¾æ–°çš„åŒ…åä¸ºcom.oc.objectiveï¼Œä¸‹é¢å‡ å¤„åœ°æ–¹æ˜¯éœ€è¦åŒæ­¥ä¿®æ”¹çš„ï¼š ä¸¤ä¸ªJavaæ–‡ä»¶android/app/src/main/java/com/PROJECT_NAME/MainActivity.java android/app/src/main/java/com/PROJECT_NAME/MainApplication.java ä¿®æ”¹ç¬¬ä¸€è¡Œçš„packageä¸ºï¼š package com.oc.objective; å®‰å“æè¿°æ–‡ä»¶android/app/src/main/AndroidManifest.xml ä¿®æ”¹ç¬¬äºŒè¡Œpackageä¸ºï¼š package=&quot;com.oc.objective&quot; ä¸¤ä¸ªæ‰“åŒ…è„šæœ¬ **android/app/BUCK** é‡Œé¢æœ‰ä¸¤å¤„packageï¼Œéƒ½ä¿®æ”¹ä¸ºæ–°çš„åŒ…å 12345678910android_build_config( ... package = &quot;com.oc.objective&quot;,)android_resource( ... package = &quot;com.oc.objective&quot;,...) **android/app/build.gradle** ä¿®æ”¹applicationId 1234defaultConfig { applicationId &quot;com.oc.objective&quot; ...} ä¿®æ”¹å®Œæˆåï¼Œå‘½ä»¤è¡Œè¿›å…¥androidç›®å½•ï¼Œæ‰§è¡Œ./gradlew cleanæ¸…é™¤ç¼“å­˜å³å¯ï¼ˆwindowsä¸Šæ˜¯ gradlew.batï¼‰ æ›´æ–°Javaæ–‡ä»¶ç›®å½•è‡³æ­¤èƒ½å¤Ÿæ‰“åŒ…å‡ºæ­£ç¡®åŒ…åçš„apkï¼Œä¸è¿‡åœ¨å¼€å‘è¿‡ç¨‹ä¸­æˆ‘ä»¬éƒ½éœ€è¦è‡ªåŠ¨linkåŸç”Ÿæ¨¡å—ï¼Œç°åœ¨Javaæ–‡ä»¶ç›®å½•ä¸æ­£ç¡®ä¼šå¯¼è‡´æ— æ³•linkæˆåŠŸï¼Œæ‰€ä»¥è¿˜éœ€è¦æŒ‰ç…§Javaçš„è§„èŒƒæŠŠJavaæ–‡ä»¶ç›®å½•æ”¾å…¥åŒ…ååŒ¹é…çš„ç›®å½•ä¸­ã€‚ æŠŠMainActivity.javaå’ŒMainApplication.javaä¸¤ä¸ªæ–‡ä»¶ç§»åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸‹ï¼šandroid/app/src/main/java/com/oc/objective/ã€‚ ä¿®æ”¹å®Œæˆçš„ç›®å½•ç»“æ„ä¸ºï¼š 12android/app/src/main/java/com/PROJECT_NAME/MainActivity.javaandroid/app/src/main/java/com/PROJECT_NAME/MainApplication.java ç°åœ¨å°±å¯ä»¥è‡ªåŠ¨linkäº†ã€‚","link":"/2019/07/05/ReactNativeåº”ç”¨åŒ…åä¿®æ”¹/"},{"title":"Axiosåœ¨é¡¹ç›®ä¸­çš„å°è£…","text":"å®é™…é¡¹ç›®å¼€å‘ä¸­ç”¨åˆ°çš„Axioså°è£… TOKENéªŒè¯å¯ä»¥åœ¨æ¯æ¬¡è¯·æ±‚ä¹‹å‰éªŒè¯tokenä¿¡æ¯ï¼š 123456// åœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­åŠ å…¥ï¼Œç”¨åˆ°äº†js-cookieimport Cookies from &apos;js-cookie&apos;;if (Cookies.get(&apos;Admin-Token&apos;)) { config.headers[&apos;Authorization&apos;] = Cookies.get(&apos;Admin-Token&apos;)} ç½‘ç»œä¼˜åŒ–å½“å¤šæ¬¡è¯·æ±‚çš„æ—¶å€™å»é™¤ä¸Šä¸€æ¬¡è¯·æ±‚ï¼Œé¿å…è¿”å›æ•°æ®ä¸åŠæ—¶å¯¼è‡´çš„æ•°æ®é”™ä¹±ï¼š 12345678910111213141516let pending = []let CancelToken = axios.CancelToken let cancelPending = (config) =&gt; { pending.forEach((item, index) =&gt; { if (config) { if (item.UrlPath === config.url) { item.Cancel() // å–æ¶ˆè¯·æ±‚ pending.splice(index, 1) // ç§»é™¤å½“å‰è¯·æ±‚è®°å½• }; } else { item.Cancel() // å–æ¶ˆè¯·æ±‚ pending.splice(index, 1) // ç§»é™¤å½“å‰è¯·æ±‚è®°å½• } })} å…¨å±€Loading12345678910111213141516import { Loading } from &apos;element-ui&apos; let loading;// ä½¿ç”¨Elementçš„loading-startæ–¹æ³•let startLoading = () =&gt; { loading = Loading.service({ lock: true, text: &apos;åŠ è½½ä¸­â€¦â€¦&apos; // background: &apos;rgba(0, 0, 0, 0.7)&apos; })}// ä½¿ç”¨Elementçš„loading-closeæ–¹æ³•let endLoading = () =&gt; { loading.close()} ä¹‹ååœ¨è¯·æ±‚æ‹¦æˆªå™¨ä¸­åŠ å…¥startLoading()æ–¹æ³•ï¼Œåœ¨è¿”å›æ‹¦æˆªå™¨ä¸­åŠ å…¥endLoading()æ–¹æ³• å…¨éƒ¨ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133import axios from 'axios';import qs from 'qs';import { SERVER_ADDRESS } from '../const/index';import { getToken } from '../utils/common';/** * AxiosäºŒæ¬¡å°è£… */let pending = []let CancelToken = axios.CancelTokenlet cancelPending = (config) =&gt; { pending.forEach((item, index) =&gt; { if (config) { if (item.UrlPath === config.url) { item.Cancel() // å–æ¶ˆè¯·æ±‚ pending.splice(index, 1) // ç§»é™¤å½“å‰è¯·æ±‚è®°å½• }; } else { item.Cancel() // å–æ¶ˆè¯·æ±‚ pending.splice(index, 1) // ç§»é™¤å½“å‰è¯·æ±‚è®°å½• } })}/** Axioså®ä¾‹åŸºç¡€é…ç½® */axios.defaults.baseURL = `${SERVER_ADDRESS}`;axios.defaults.timeout = 100000;/** è¯·æ±‚æ‹¦æˆªå™¨ */axios.interceptors.request.use(async config =&gt; { config.headers['Authorization'] = await getToken(); // 1. å¦‚æœæœ‰å­˜åœ¨çš„è¯·æ±‚ï¼Œå–æ¶ˆæ‰ cancelPending(config) // 2. pendingåˆ—è¡¨åŠ å…¥æ­¤æ¬¡æ–°çš„è¯·æ±‚ config.cancelToken = new CancelToken(res =&gt; { pending.push({'UrlPath': config.url, 'Cancel': res}) }); if (config.method === 'get') { config.params = { ...config.data, _t: Date.parse(new Date()) / 1000 } } return config}, error =&gt; { console.log(error) return Promise.reject(error)})/** è¿”å›æ‹¦æˆªå™¨ */axios.interceptors.response.use(response =&gt; { cancelPending(response.config) if (response.status === '200' || response.status === 200) { return response.data.data || response.data } else { // é200è¯·æ±‚åˆ™æŠ¥é”™ throw Error(response.opt || 'éæ³•çš„çŠ¶æ€ç ') }}, error =&gt; { console.log(error) return Promise.reject(error)})export default class http { static async get(url, params) { /** * params{ * goodsï¼šidï¼Œ * nameï¼šstring * } ==&gt; ?goods=id&amp;name=string */ try { let query = await qs.stringify(params) let res = null; if (!params) { // console.log( SERVER_ADDRESS + url); res = await axios.get(url) } else { // console.log( SERVER_ADDRESS + url + '?' + query); res = await axios.get(url + '?' + query) } return res } catch (error) { return error } } static async post(url, params) { try { let res = await axios.post(url, params) return res } catch (error) { return error } } static async patch(url, params) { try { let res = await axios.patch(url, params) return res } catch (error) { return error } } static async put(url, params) { try { let res = await axios.put(url, params) return res } catch (error) { return error } } static async delete(url, params) { /** * paramsé»˜è®¤ä¸ºæ•°ç»„ */ try { let res = await axios.post(url, params) return res } catch (error) { return error } }}","link":"/2019/06/27/Axiosåœ¨é¡¹ç›®ä¸­çš„å°è£…/"},{"title":"æ™®é€šäººçš„ç½‘é¡µé…è‰²æ–¹æ¡ˆ","text":"å‰æ®µæ—¶é—´åœ¨é˜®è€å¸ˆåšå®¢ä¸Šçœ‹åˆ°çš„æ–‡ç« ï¼Œå‡ ä¸ªé…è‰²è‡ªå·±ç”¨ä¸‹æ¥è¿˜ä¸é”™ï¼Œåœ¨æ­¤å•ç‹¬è®°å½•ä¸€ä¸‹ã€‚ Flat UI è‰²è¡¨ æ›´å¤šçš„è®¾è®¡é£æ ¼å¯ä»¥æŸ¥çœ‹Flat UI å®˜ç½‘ã€‚ é…è‰²çš„ç»éªŒæ³•åˆ™æœ‰äººè¿˜æå‡ºä¸€ç§é…è‰²çš„ç»éªŒæ³•åˆ™ï¼š æ–‡å­—é¢œè‰²æ–‡å­—æœ€å¥½ä¸è¦ä½¿ç”¨å…¨é»‘ï¼Œè€Œæ˜¯ä½¿ç”¨æ·±è“è‰²ï¼Œå¯ä»¥ä»ä¸‹é¢å‡ ç§é¢œè‰²æŒ‘ã€‚1a2a3aæœ€æ·±ï¼Œ2a3a4aæ¬¡ä¹‹ï¼Œ7a8a9aæœ€æµ…ã€‚ èƒŒæ™¯è‰²ã€é˜´å½±è‰²ã€è¾¹æ¡†è‰²èƒŒæ™¯è‰²ã€é˜´å½±è‰²ã€è¾¹æ¡†è‰²éƒ½å±äºè¡¬æ‰˜ï¼Œå»ºè®®ä½¿ç”¨ç°è‰²ï¼Œå¯ä»¥ä»aaaaaã€bbbbbbã€ccccccã€ddddddè¿™å››ä¸ªè‰²å€¼æŒ‘é€‰ã€‚","link":"/2019/07/11/æ™®é€šäººçš„ç½‘é¡µé…è‰²æ–¹æ¡ˆ/"},{"title":"å¸ƒå±€ï¼šæ°´å¹³å±…ä¸­ã€å‚ç›´å±…ä¸­ã€æ°´å¹³å‚ç›´å±…ä¸­","text":"æ°´å¹³å±…ä¸­absolute + transformï¼ˆæ¨èï¼‰transformä¸ºcss3å±æ€§ï¼Œå…¼å®¹åˆ°IE10ï¼ŒIE9æ·»åŠ -ms-transform å±æ€§ 12345678910111213&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { position:relative;}.child { position:absolute; left:50%; transform:translateX(-50%); //å†å‘å·¦åç§»è‡ªèº«å®½åº¦çš„ä¸€åŠ} flex + marginï¼ˆæ¨èï¼‰flexä¸ºcss3å±æ€§ï¼Œå…¼å®¹åˆ°IE9 1234567891011&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { display:flex;}.child { margin:0 auto;} flex + justify-contentï¼ˆæ¨èï¼‰flexä¸ºcss3å±æ€§ï¼Œå…¼å®¹åˆ°IE9 123456789&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { display:flex; justify-content:center;} inline-block + text-alignæŠŠå­å…ƒç´ è®¾ä¸ºinline-block å…ƒç´ ï¼Œç„¶åå¯¹çˆ¶å…ƒç´ è®¾ç½®text-align:center è®©å­å…ƒç´ å±…ä¸­ï¼Œå…¼å®¹åˆ°IE6 123456789101112&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.child{ display:inline-block; text-align:center; //é¿å…childé‡Œé¢çš„æ–‡å­—ä¹Ÿæ°´å¹³å±…ä¸­}.parent{ text-align:center;} table + marginå…¼å®¹åˆ°IE8 123456789&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.child{ display:table; //divè¢«æ¢æˆäº†table margin:0 auto;} å‚ç›´å±…ä¸­absolute + transformï¼ˆæ¨èï¼‰ç±»ä¼¼äºæ°´å¹³å±…ä¸­çš„é‚£ä¸ªæ–¹æ³• transformä¸ºcss3å±æ€§ï¼Œå…¼å®¹åˆ°IE10ï¼ŒIE9æ·»åŠ -ms-transform å±æ€§ 12345678910111213&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { position:relative;}.child { position:absolute; top:50%; transform:translateY(-50%);} flex + align-itemsï¼ˆæ¨èï¼‰ç±»ä¼¼äºæ°´å¹³å±…ä¸­çš„é‚£ä¸ªæ–¹æ³• flexä¸ºcss3å±æ€§ï¼Œå…¼å®¹åˆ°IE9 123456789&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { position:flex; align-items:center;} table-cell + vertical-alignå…¼å®¹åˆ°IE8 123456789&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { display:table-cell; //1.å°†çˆ¶æ¡†è½¬åŒ–ä¸ºä¸€ä¸ªè¡¨æ ¼å•å…ƒæ ¼ vertical-align:middle; //2.ä½¿è¡¨æ ¼å•å…ƒæ ¼å†…å®¹å‚ç›´å±…ä¸­} æ°´å¹³å‚ç›´å±…ä¸­flex + marginï¼ˆéå¸¸æ¨èï¼‰123456789101112131415&lt;div class=\"parent\"&gt; &lt;div class=\"child \"&gt;&lt;/div&gt;&lt;/div&gt;.parent { background-color: lightblue; height: 500px; display: flex; /* å…³é”®ä»£ç  */}.child { width: 100px; height: 100px; background-color: lightseagreen; margin: auto; /* å…³é”®ä»£ç  */} flex + justify-content + align-itemsï¼ˆæ¨èï¼‰12345678910&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent{ display:flex; justify-content:center; //æ°´å¹³å±…ä¸­ align-items:center; //å‚ç›´å±…ä¸­} absolute + transformï¼ˆæ¨èï¼‰1234567891011121314&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.parent { position:relative;}.child { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);} inline-block + text-align + table-cell + vertical-align12345678910111213&lt;div class=\"parent\" style=\"background:red\"&gt; &lt;div class=\"child\" style=\"background:yellow\"&gt;DEMO&lt;/div&gt;&lt;/div&gt;.child { display:inline-block; //1.æ°´å¹³å±…ä¸­}.parent { text-align:center; //2.æ°´å¹³å±…ä¸­ display:table-cell; //3.å‚ç›´å±…ä¸­ vertical-align:middle; //4.å‚ç›´å±…ä¸­}","link":"/2019/07/12/å¸ƒå±€ï¼šæ°´å¹³å±…ä¸­ã€å‚ç›´å±…ä¸­ã€æ°´å¹³å‚ç›´å±…ä¸­/"},{"title":"æ•°æ®ç»“æ„ï¼šå…«å¤§æ’åº","text":"å„ç§æ’åºç®—æ³•æ—¶é—´å¤æ‚åº¦ å„ç§å¸¸ç”¨æ’åºç®—æ³• ç±»åˆ« æ’åºæ–¹æ³• æ—¶é—´å¤æ‚åº¦ ç©ºé—´å¤æ‚åº¦ ç¨³å®šæ€§ å¤æ‚æ€§ ç‰¹ç‚¹ æœ€å¥½ å¹³å‡ æœ€å è¾…åŠ©å­˜å‚¨ ç®€å• æ’å…¥æ’åº ç›´æ¥æ’å…¥ O(N) O(N2) O(N2) O(1) ç¨³å®š ç®€å• å¸Œå°”æ’åº O(N) O(N1.3) O(N2) O(1) ä¸ç¨³å®š å¤æ‚ é€‰æ‹©æ’åº ç›´æ¥é€‰æ‹© O(N) O(N2) O(N2) O(1) ä¸ç¨³å®š å †æ’åº O(N*log2N) O(N*log2N) O(N*log2N) O(1) ä¸ç¨³å®š å¤æ‚ äº¤æ¢æ’åº å†’æ³¡æ’åº O(N) O(N2) O(N2) O(1) ç¨³å®š ç®€å• 1ã€å†’æ³¡æ’åºæ˜¯ä¸€ç§ç”¨æ—¶é—´æ¢ç©ºé—´çš„æ’åºæ–¹æ³•ï¼Œnå°æ—¶å¥½ 2ã€æœ€åæƒ…å†µæ˜¯æŠŠé¡ºåºçš„æ’åˆ—å˜æˆé€†åºï¼Œæˆ–è€…æŠŠé€†åºçš„æ•°åˆ—å˜æˆé¡ºåºï¼Œæœ€å·®æ—¶é—´å¤æ‚åº¦O(N^2)åªæ˜¯è¡¨ç¤ºå…¶æ“ä½œæ¬¡æ•°çš„æ•°é‡çº§ 3ã€æœ€å¥½çš„æƒ…å†µæ˜¯æ•°æ®æœ¬æ¥å°±æœ‰åºï¼Œå¤æ‚åº¦ä¸ºO(n) å¿«é€Ÿæ’åº O(N*log2N) O(N*log2N) O(N2) O(log2n)~O(n) ä¸ç¨³å®š å¤æ‚ 1ã€nå¤§æ—¶å¥½ï¼Œå¿«é€Ÿæ’åºæ¯”è¾ƒå ç”¨å†…å­˜ï¼Œå†…å­˜éšnçš„å¢å¤§è€Œå¢å¤§ï¼Œä½†å´æ˜¯æ•ˆç‡é«˜ä¸ç¨³å®šçš„æ’åºç®—æ³•ã€‚ 2ã€åˆ’åˆ†ä¹‹åä¸€è¾¹æ˜¯ä¸€ä¸ªï¼Œä¸€è¾¹æ˜¯n-1ä¸ªï¼Œ è¿™ç§æç«¯æƒ…å†µçš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯O(N^2) 3ã€æœ€å¥½çš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½èƒ½å‡åŒ€çš„åˆ’åˆ†åºåˆ—ï¼ŒO(N*log2N) å½’å¹¶æ’åº O(N*log2N) O(N*log2N) O(N*log2N) O(n) ç¨³å®š å¤æ‚ 1ã€nå¤§æ—¶å¥½ï¼Œå½’å¹¶æ¯”è¾ƒå ç”¨å†…å­˜ï¼Œå†…å­˜éšnçš„å¢å¤§è€Œå¢å¤§ï¼Œä½†å´æ˜¯æ•ˆç‡é«˜ä¸”ç¨³å®šçš„æ’åºç®—æ³•ã€‚ åŸºæ•°æ’åº O(d(r+n)) O(d(r+n)) O(d(r+n)) O(rd+n) ç¨³å®š å¤æ‚ æ³¨ï¼šrä»£è¡¨å…³é”®å­—åŸºæ•°ï¼Œdä»£è¡¨é•¿åº¦ï¼Œnä»£è¡¨å…³é”®å­—ä¸ªæ•° æ³¨ï¼š å½’å¹¶æ’åºæ¯æ¬¡é€’å½’éƒ½è¦ç”¨åˆ°ä¸€ä¸ªè¾…åŠ©è¡¨ï¼Œé•¿åº¦ä¸å¾…æ’åºçš„è¡¨é•¿åº¦ç›¸åŒï¼Œè™½ç„¶é€’å½’æ¬¡æ•°æ˜¯O(log2n)ï¼Œä½†æ¯æ¬¡é€’å½’éƒ½ä¼šé‡Šæ”¾æ‰æ‰€å çš„è¾…åŠ©ç©ºé—´ã€‚ å¿«é€Ÿæ’åºç©ºé—´å¤æ‚åº¦åªæ˜¯åœ¨é€šå¸¸æƒ…å†µä¸‹æ‰ä¸ºO(log2n)ï¼Œå¦‚æœæ˜¯æœ€åæƒ…å†µçš„è¯ï¼Œå¾ˆæ˜¾ç„¶å°±è¦O(n)çš„ç©ºé—´äº†ã€‚å½“ç„¶ï¼Œå¯ä»¥é€šè¿‡éšæœºåŒ–é€‰æ‹©pivotæ¥å°†ç©ºé—´å¤æ‚åº¦é™ä½åˆ°O(log2n)ã€‚ ç›¸å…³æ¦‚å¿µï¼š æ—¶é—´å¤æ‚åº¦ â€‹ æ—¶é—´å¤æ‚åº¦å¯ä»¥è®¤ä¸ºæ˜¯å¯¹æ’åºæ•°æ®çš„æ€»çš„æ“ä½œæ¬¡æ•°ã€‚åæ˜ å½“nå˜åŒ–æ—¶ï¼Œæ“ä½œæ¬¡æ•°å‘ˆç°ä»€ä¹ˆè§„å¾‹ã€‚ â€‹ å¸¸è§çš„æ—¶é—´å¤æ‚åº¦æœ‰ï¼š â€‹ å¸¸æ•°é˜¶O(1)ï¼Œå¯¹æ•°é˜¶O(log2n)ï¼Œçº¿æ€§é˜¶O(n)ï¼Œçº¿æ€§å¯¹æ•°é˜¶O(nlog2n)ï¼Œå¹³æ–¹é˜¶O(n2) â€‹ æ—¶é—´å¤æ‚åº¦O(1)ï¼šç®—æ³•ä¸­è¯­å¥æ‰§è¡Œæ¬¡æ•°ä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ã€‚ ç©ºé—´å¤æ‚åº¦ â€‹ ç©ºé—´å¤æ‚åº¦æ˜¯æŒ‡ç®—æ³•åœ¨è®¡ç®—æœºå†…æ‰§è¡Œæ—¶æ‰€éœ€å­˜å‚¨ç©ºé—´çš„åº¦é‡ï¼Œå®ƒä¹Ÿæ˜¯é—®é¢˜è§„æ¨¡nçš„å‡½æ•°ã€‚ â€‹ ç©ºé—´å¤æ‚åº¦O(1)ï¼šå½“ä¸€ä¸ªç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œå³ä¸éšè¢«å¤„ç†æ•°æ®é‡nçš„å¤§å°è€Œæ”¹å˜æ—¶ï¼Œå¯è¡¨ç¤ºä¸ºO(1)ã€‚ â€‹ ç©ºé—´å¤æ‚åº¦O(log2N)ï¼šå½“ä¸€ä¸ªç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸ä»¥2ä¸ºåº•çš„nçš„å¯¹æ•°æˆæ­£æ¯”æ—¶ï¼Œå¯è¡¨ç¤ºä¸ºO(log2n) â€‹ ax=Nï¼Œåˆ™x=logaNã€‚ â€‹ ç©ºé—´å¤æ‚åº¦O(n)ï¼šå½“ä¸€ä¸ªç®—æ³•çš„ç©ºé—´å¤æ‚åº¦ä¸næˆçº¿æ€§æ¯”ä¾‹å…³ç³»æ—¶ï¼Œå¯è¡¨ç¤ºä¸º0(n)ã€‚","link":"/2019/07/10/æ•°æ®ç»“æ„ï¼šå…«å¤§æ’åº/"},{"title":"å†™ç»™è‡ªå·±çœ‹çš„ReactHookç¬”è®°","text":"Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚ å‚è€ƒæ–‡æ¡£åœ°å€ Hookç®€ä»‹ä»€ä¹ˆæ˜¯HookHook æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒå¯ä»¥è®©ä½ â€œé’©å…¥â€ React çš„ç‰¹æ€§ã€‚ ä»€ä¹ˆæ—¶å€™æˆ‘ä¼šç”¨Hookå¦‚æœä½ åœ¨ç¼–å†™å‡½æ•°ç»„ä»¶å¹¶æ„è¯†åˆ°éœ€è¦å‘å…¶æ·»åŠ ä¸€äº› stateï¼Œä»¥å‰çš„åšæ³•æ˜¯å¿…é¡»å°†å…¶å®ƒè½¬åŒ–ä¸º classã€‚ç°åœ¨ä½ å¯ä»¥åœ¨ç°æœ‰çš„å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ Hookã€‚ ä¸ºä»€ä¹ˆä»¥useå¼€å¤´ä½ å¯èƒ½æƒ³çŸ¥é“ï¼šä¸ºä»€ä¹ˆå« useState è€Œä¸å« createState? â€œCreateâ€ å¯èƒ½ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œå› ä¸º state åªåœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™è¢«åˆ›å»ºã€‚åœ¨ä¸‹ä¸€æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼ŒuseState è¿”å›ç»™æˆ‘ä»¬å½“å‰çš„ stateã€‚å¦åˆ™å®ƒå°±ä¸æ˜¯ â€œstateâ€äº†ï¼è¿™ä¹Ÿæ˜¯ Hook çš„åå­—æ€»æ˜¯ä»¥ use å¼€å¤´çš„ä¸€ä¸ªåŸå› ã€‚ ä½¿ç”¨State Hookåœ¨State Hookä¸­æˆ‘ä»¬ä¼šç”¨åˆ°useStateï¼Œå®ƒæ˜¯å…è®¸ä½ åœ¨ React å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ  state çš„ Hook ç­‰ä»·ä»£ç åœ¨è¿™é‡Œæˆ‘ä»¬ä¸¾ä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨ä¾‹å­ï¼Œä»¥å‰classçš„å†™æ³•ï¼š 12345678910111213141516171819class Example extends React.Component { constructor(props) { super(props); this.state = { count: 0 }; } render() { return ( &lt;div&gt; &lt;p&gt;You clicked {this.state.count} times&lt;/p&gt; &lt;button onClick={() =&gt; this.setState({ count: this.state.count + 1 })}&gt; Click me &lt;/button&gt; &lt;/div&gt; ); }} ç°åœ¨Hookçš„å†™æ³•ï¼š 1234567891011121314151617// 1.å¼•å…¥useState Hookimport React, { useState } from 'react';function Example() { // 2.å£°æ˜ä¸€ä¸ªå«\"count\"çš„stateå˜é‡ï¼Œå’Œå¯ä»¥æ›´æ–°å®ƒçš„å‡½æ•°\"setCount\" const [count, setCount] = useState(0); return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; // 3.ç‚¹å‡»åï¼Œæ›´æ–°\"count\"çš„å€¼ï¼Œé‡æ–°æ¸²æŸ“\"Example\"ç»„ä»¶ï¼Œå¹¶ä¼ å…¥æ›´æ–°åçš„\"count\" &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; );} åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰thisï¼Œæ‰€ä»¥ä¸å†é€šè¿‡this.stateæ¥è¯»å–å±æ€§ï¼Œè€Œæ˜¯é€šè¿‡useStateè°ƒç”¨ã€‚ useStateåœ¨è°ƒç”¨æ—¶åšäº†ä»€ä¹ˆ å®ƒå®šä¹‰ä¸€ä¸ª â€œstate å˜é‡â€ã€‚ è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬çš„å˜é‡å« countï¼Œ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å«ä»–ä»»ä½•åå­—ï¼Œæ¯”å¦‚ bananaã€‚ è¿™æ˜¯ä¸€ç§åœ¨å‡½æ•°è°ƒç”¨æ—¶ä¿å­˜å˜é‡çš„æ–¹å¼ â€”â€” useStateæ˜¯ä¸€ç§æ–°æ–¹æ³•ï¼Œå®ƒä¸ class é‡Œé¢çš„ this.state æä¾›çš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨å‡½æ•°é€€å‡ºåå˜é‡å°±å°±ä¼šâ€æ¶ˆå¤±â€ï¼Œè€Œ state ä¸­çš„å˜é‡ä¼šè¢« React ä¿ç•™ã€‚ useStateçš„è¿”å›å€¼æ˜¯ä»€ä¹ˆè¿”å›å€¼ä¸ºï¼šâ‘ å½“å‰ stateï¼Œâ‘¡æ›´æ–° state æ‰€è°ƒç”¨çš„å‡½æ•°ã€‚ const [count, setCount] = useState(0); æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå« count çš„ state å˜é‡ï¼Œç„¶åæŠŠå®ƒè®¾ä¸º 0ã€‚React ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶è®°ä½å®ƒå½“å‰çš„å€¼ï¼Œå¹¶ä¸”æä¾›æœ€æ–°çš„å€¼ç»™æˆ‘ä»¬çš„å‡½æ•°ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ setCount æ¥æ›´æ–°å½“å‰çš„ countã€‚ è¯»å–Stateåœ¨å‡½æ•°å†™æ³•ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨countï¼š 1&lt;p&gt;You clicked {count} times&lt;/p&gt; ä»¥å‰çš„classå†™æ³•ä¸­ï¼Œæ˜¯this.state.count æ›´æ–°Stateåœ¨å‡½æ•°å†™æ³•ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨åœ¨useStateæ—¶è¿”å›çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¥æ›´æ–°æ•°æ®ã€‚ åœ¨æœ¬ä¾‹å­ä¸­ï¼Œå³setCountï¼š 123&lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me&lt;/button&gt; ä»¥å‰çš„classå†™æ³•ä¸­ï¼Œæ˜¯this.setState({count: this.state.count + 1}) ä½¿ç”¨å¤šä¸ªstateå˜é‡12345function ExampleWithManyStates() { // å£°æ˜å¤šä¸ª state å˜é‡ const [age, setAge] = useState(42); const [fruit, setFruit] = useState(&apos;banana&apos;); const [todos, setTodos] = useState([{ text: &apos;å­¦ä¹  Hook&apos; }]); ä½¿ç”¨Effect Hookä½¿ç”¨Effect Hookçš„ä¸€ä¸ªä¸»è¦ç›®çš„æ˜¯è§£å†³classä¸­åŒä¸€ç”Ÿå‘½å‘¨æœŸç»å¸¸åŒ…å«ä¸ç›¸å…³çš„é€»è¾‘ï¼Œä½†åˆæŠŠç›¸å…³çš„é€»è¾‘åˆ†ç¦»åˆ°äº†å‡ ä¸ªä¸åŒæ–¹æ³•ä¸­çš„é—®é¢˜ã€‚ ä»€ä¹ˆæ˜¯Effect HookuseEffect ç›¸å½“äºcomponentDidMountï¼ŒcomponentDidUpdateï¼ŒcomponentWillUnmount è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆ 123456789101112131415161718192021222324import React, { useState, useEffect } from &apos;react&apos;;function Example() { const [count, setCount] = useState(0); useEffect(() =&gt; { // è®¢é˜… document.title = `You clicked ${count} times`; // æ¸…é™¤ï¼ˆå¯é€‰ï¼‰ return () =&gt; { // do something cleanup } }); return ( &lt;div&gt; &lt;p&gt;You clicked {count} times&lt;/p&gt; &lt;button onClick={() =&gt; setCount(count + 1)}&gt; Click me &lt;/button&gt; &lt;/div&gt; );} åœ¨ä»¥å‰classå†™æ³•ä¸­ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶åŠ è½½å’Œæ›´æ–°æ—¶éƒ½è°ƒç”¨åŒæ ·çš„æ–¹æ³•ï¼Œå°±éœ€è¦åœ¨componentDidMountå’ŒcomponentDidUpdateå†™é‡å¤çš„ä»£ç ã€‚ ä½¿ç”¨useEffectï¼Œreactä¼šä¿å­˜ä½ ä¼ é€’çš„å‡½æ•°ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€™effectâ€™ï¼‰ï¼Œå¹¶ä¸”åœ¨DOMæ›´æ–°ä¹‹åè°ƒç”¨å®ƒã€‚å‡å°‘äº†é‡å¤ä»£ç ã€‚useEffectè°ƒç”¨effectä¸ä¼šé˜»å¡æµè§ˆå™¨åˆ·æ–°å±å¹•ï¼Œè¿™è®©ä½ çš„åº”ç”¨å“åº”æ›´å¿«ã€‚ï¼ˆå¦‚æœéœ€è¦åŒæ­¥åœ°æ‰§è¡Œï¼Œå¦‚ç€‘å¸ƒæµï¼Œä½¿ç”¨useLayoutEffect Hookï¼‰ Hookä½¿ç”¨çš„JSçš„é—­åŒ…æœºåˆ¶ï¼šuseEffectæ”¾åœ¨ç»„ä»¶å†…éƒ¨è®©æˆ‘ä»¬å¯ä»¥åœ¨effectä¸­ç›´æ¥è®¿é—®count stateå˜é‡ï¼ˆæˆ–å…¶ä»–propsï¼‰ï¼Œå®ƒå·²ç»ä¿å­˜åœ¨äº†å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸éœ€è¦å…¶ä»–APIã€‚ åŒºåˆ«äºvue Hookï¼ŒuseEffectåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åå’Œæ¯æ¬¡æ›´æ–°ä¹‹åéƒ½ä¼šæ‰§è¡Œã€‚ æ¸…é™¤Effectåœ¨classå†™æ³•ä¸­ï¼Œæˆ‘ä»¬åœ¨ componentDidMountä¸­è®¢é˜…ï¼Œåœ¨componentWillUnmountä¸­æ¸…é™¤ã€‚ ä½¿ç”¨useEffectï¼Œåœ¨å°¾éƒ¨è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°ï¼Œreactå°±ä¼šåœ¨ç»„ä»¶å¸è½½æ—¶æ‰§è¡Œæ¸…é™¤æ“ä½œæ¥è°ƒç”¨å®ƒã€‚è¿™æ ·è®¢é˜…å’Œç§»é™¤è®¢é˜…çš„é€»è¾‘éƒ½æ”¾åœ¨äº†ä¸€èµ·ã€‚ å¦å¤–ï¼Œè¿”å›çš„æ¸…é™¤å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°è€Œä¸éœ€è¦å‘½åã€‚ ä½¿ç”¨å¤šä¸ªEffectåˆ†ç¦»é€»è¾‘å°±åƒä½ å¯ä»¥ä½¿ç”¨å¤šä¸ªstateçš„Hookï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ªeffectæ¥å°†ä¸åŒçš„é€»è¾‘åˆ†ç¦»ã€‚Hook å…è®¸æˆ‘ä»¬æŒ‰ç…§ä»£ç çš„ç”¨é€”åˆ†ç¦»ä»–ä»¬ï¼Œ è€Œä¸æ˜¯åƒç”Ÿå‘½å‘¨æœŸå‡½æ•°é‚£æ ·ã€‚React å°†æŒ‰ç…§ effect å£°æ˜çš„é¡ºåºä¾æ¬¡è°ƒç”¨ç»„ä»¶ä¸­çš„æ¯ä¸€ä¸ª effectï¼ˆvue Hookæ˜¯æ²¡æœ‰é¡ºåºçš„ï¼‰ã€‚ ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡ŒEffectä¾‹å¦‚ä¸€ä¸ªå¥½å‹åœ¨çº¿çŠ¶æ€çš„å±•ç¤ºï¼Œå¦‚æœæ˜¯classå†™æ³•ï¼Œæˆ‘ä»¬ä»propsä¸­è·å–friend.idï¼Œç„¶ååœ¨componentDidMountè®¢é˜…å’ŒcomponentWillUnmountæ¸…é™¤è®¢é˜…ï¼Œä½†æ˜¯å½“ç»„ä»¶å·²ç»æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œfriend.idæ”¹å˜å¯¼è‡´BUGï¼Œç»„ä»¶å°†ç»§ç»­å±•ç¤ºåŸæ¥çš„å¥½å‹çŠ¶æ€ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜ä¼šå› ä¸ºå–æ¶ˆè®¢é˜…æ—¶ä½¿ç”¨é”™è¯¯çš„å¥½å‹ ID å¯¼è‡´å†…å­˜æ³„éœ²æˆ–å´©æºƒçš„é—®é¢˜ã€‚æˆ‘ä»¬å¿…é¡»ä½¿ç”¨componentDidUpdateæ¥è§£å†³é—®é¢˜ï¼Œå¦‚ä¸‹ä»£ç ï¼š 123456789101112131415161718192021222324252627componentDidMount() { ChatAPI.subscribeToFriendStatus( this.props.friend.id, this.handleStatusChange );}// æ·»åŠ è¿™é‡Œçš„ä»£ç è§£å†³BUGcomponentDidUpdate(prevProps) { // å–æ¶ˆè®¢é˜…ä¹‹å‰çš„ friend.id ChatAPI.unsubscribeFromFriendStatus( prevProps.friend.id, this.handleStatusChange ); // è®¢é˜…æ–°çš„ friend.id ChatAPI.subscribeToFriendStatus( this.props.friend.id, this.handleStatusChange );}componentWillUnmount() { ChatAPI.unsubscribeFromFriendStatus( this.props.friend.id, this.handleStatusChange );} ä½¿ç”¨Hookç‰ˆæœ¬ï¼š 123456789function FriendStatus(props) { // ... useEffect(() =&gt; { // ... ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange); return () =&gt; { ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange); }; }); æ²¡æœ‰æ·»åŠ ä»»ä½•é¢å¤–çš„é€»è¾‘æ”¹åŠ¨ï¼Œå´å¯ä»¥ä¸å—æ­¤BUGå½±å“ã€‚å› ä¸ºé»˜è®¤åœ¨è°ƒç”¨ä¸€ä¸ªæ–°çš„effectä¹‹å‰ä¼šå¯¹å‰ä¸€ä¸ªeffectè¿›è¡Œæ¸…ç†ã€‚ è·³è¿‡ Effect è¿›è¡Œæ€§èƒ½ä¼˜åŒ–åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œæˆ–æ¸…ç†effectä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ åœ¨classå†™æ³•ä¸­ï¼Œé€šè¿‡componentDidUpdateè§£å†³ï¼š 123456// åˆ¤æ–­æ˜¯å¦æ›´æ–°äº†componentDidUpdate(prevProps, prevState) { if (prevState.count !== this.state.count) { document.title = `You clicked ${this.state.count} times`; }} åœ¨Hookä¸­ï¼Œä¼ é€’æ•°ç»„ä½œä¸ºuseEffectçš„ç¬¬äºŒä¸ªå‚æ•°å³å¯ï¼š 123useEffect(() =&gt; { document.title = `You clicked ${count} times`;}, [count]); // ä»…åœ¨ count æ›´æ”¹æ—¶æ›´æ–° å¯¹äºæ¸…é™¤effectåŒæ ·é€‚ç”¨ï¼š 12345678910useEffect(() =&gt; { function handleStatusChange(status) { setIsOnline(status.isOnline); } ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange); return () =&gt; { ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange); };}, [props.friend.id]); // ä»…åœ¨ props.friend.id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è®¢é˜… Hookè§„åˆ™åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨Hook ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶ï¼ŒåµŒå¥—å‡½æ•°ä¸­è°ƒç”¨Hook å¦‚æœæƒ³è¦æœ‰æ¡ä»¶çš„æ‰§è¡Œä¸€ä¸ªeffectï¼Œå¯ä»¥åœ¨Hookå†…éƒ¨åˆ¤æ–­ 123456useEffect(function persistForm() { // ğŸ‘ å°†æ¡ä»¶åˆ¤æ–­æ”¾ç½®åœ¨ effect ä¸­ if (name !== &apos;&apos;) { localStorage.setItem(&apos;formData&apos;, name); }}); ç¡®ä¿æ€»åœ¨Reactå‡½æ•°æœ€é¡¶å±‚è°ƒç”¨Hook ç¡®ä¿HookæŒ‰ç…§é¡ºåºæ‰§è¡Œ ä¸è¦åœ¨æ™®é€šJavaScriptå‡½æ•°ä¸­è°ƒç”¨Hook Hookåœ¨classå†…éƒ¨æ˜¯ä¸èµ·ä½œç”¨çš„ ESLintæ’ä»¶eslint-plugin-react-hooksæ’ä»¶å¯ä»¥å¼ºåˆ¶Hookåªåœ¨Reactå‡½æ•°ä¸­è€ŒéJså‡½æ•°ä¸­è°ƒç”¨ï¼ˆä¹‹åå¯èƒ½å¹¶å…¥create react appï¼‰ npm install eslint-plugin-react-hooks --save-dev 123456789101112// ä½ çš„ ESLint é…ç½®{ &quot;plugins&quot;: [ // ... &quot;react-hooks&quot; ], &quot;rules&quot;: { // ... &quot;react-hooks/rules-of-hooks&quot;: &quot;error&quot;, // æ£€æŸ¥ Hook çš„è§„åˆ™ &quot;react-hooks/exhaustive-deps&quot;: &quot;warn&quot; // æ£€æŸ¥ effect çš„ä¾èµ– }} æŒ‰é¡ºåºæ‰§è¡Œçš„Hookåœ¨å•ä¸ªç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ª State Hook æˆ– Effect Hookï¼Œå› ä¸ºHookå¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥Reactæ‰èƒ½çŸ¥é“stateä¸å“ªä¸€ä¸ªuseStateå¯¹åº”ã€‚ 12345678910111213141516171819function Form() { // 1. Use the name state variable const [name, setName] = useState('Mary'); // 2. Use an effect for persisting the form useEffect(function persistForm() { localStorage.setItem('formData', name); }); // 3. Use the surname state variable const [surname, setSurname] = useState('Poppins'); // 4. Use an effect for updating the title useEffect(function updateTitle() { document.title = name + ' ' + surname; }); // ...} ä¸Šè¿°ä»£ç çš„å·¥ä½œå¦‚ä¸‹ï¼š 1234567891011121314151617// ------------// é¦–æ¬¡æ¸²æŸ“// ------------useState(&apos;Mary&apos;) // 1. ä½¿ç”¨ &apos;Mary&apos; åˆå§‹åŒ–å˜é‡åä¸º name çš„ stateuseEffect(persistForm) // 2. æ·»åŠ  effect ä»¥ä¿å­˜ form æ“ä½œuseState(&apos;Poppins&apos;) // 3. ä½¿ç”¨ &apos;Poppins&apos; åˆå§‹åŒ–å˜é‡åä¸º surname çš„ stateuseEffect(updateTitle) // 4. æ·»åŠ  effect ä»¥æ›´æ–°æ ‡é¢˜// -------------// äºŒæ¬¡æ¸²æŸ“// -------------useState(&apos;Mary&apos;) // 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰useEffect(persistForm) // 2. æ›¿æ¢ä¿å­˜ form çš„ effectuseState(&apos;Poppins&apos;) // 3. è¯»å–å˜é‡åä¸º surname çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰useEffect(updateTitle) // 4. æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect// ...","link":"/2019/06/20/å†™ç»™è‡ªå·±çœ‹çš„ReactHookç¬”è®°/"},{"title":"ç”¨å›¾è¡¨å’Œå®ä¾‹è§£é‡ŠAsyncå’ŒAwait","text":"ç®€ä»‹JavaScript ES7 ä¸­çš„ async / await è®©å¤šä¸ªå¼‚æ­¥ promise ååŒå·¥ä½œèµ·æ¥æ›´å®¹æ˜“ã€‚å¦‚æœè¦æŒ‰ä¸€å®šé¡ºåºä»å¤šä¸ªæ•°æ®åº“æˆ–è€… API å¼‚æ­¥è·å–æ•°æ®ï¼Œä½ å¯èƒ½ä¼šä»¥ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„ promise å’Œå›è°ƒå‡½æ•°è€Œå‘Šç»ˆã€‚è€Œ async / await ç»“æ„è®©æˆ‘ä»¬èƒ½ç”¨å¯è¯»æ€§å¼ºã€æ˜“ç»´æŠ¤çš„ä»£ç æ›´åŠ ç®€æ´åœ°å®ç°è¿™äº›é€»è¾‘ã€‚æœ¬æ•™ç¨‹ç”¨å›¾è¡¨å’Œç®€å•ç¤ºä¾‹è®²è§£äº† JavaScript ä¸­ async / await çš„è¯­æ³•å’Œè¯­ä¹‰ã€‚åœ¨æ·±å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•å›é¡¾ä¸€ä¸‹ promise. å¦‚æœä½ å·²ç»å¯¹ JS çš„ promise æœ‰æ‰€äº†è§£ï¼Œå¯æ”¾å¿ƒå¤§èƒ†åœ°è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚ åŸæ–‡åœ°å€ Promisesåœ¨ JavaScript ä¸­ï¼Œpromise ä»£è¡¨éé˜»å¡å¼‚æ­¥æ‰§è¡Œçš„æŠ½è±¡æ¦‚å¿µã€‚å¦‚æœä½ ç†Ÿæ‚‰Java çš„ Futureã€C# çš„ Task.aspx), ä½ ä¼šå‘ç° promise è·Ÿå®ƒä»¬å¾ˆåƒã€‚Promise ä¸€èˆ¬ç”¨äºç½‘ç»œå’Œ I/O æ“ä½œï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶ï¼Œæˆ–è€…åˆ›å»º HTTP è¯·æ±‚ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¼‚æ­¥ promiseï¼Œç„¶åç”¨ then æ·»åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“ promise ç»“æŸåä¼šè§¦å‘è¿™ä¸ªå›è°ƒå‡½æ•°ï¼Œè€Œéé˜»å¡ä½å½“å‰â€œçº¿ç¨‹â€ã€‚å›è°ƒå‡½æ•°æœ¬èº«ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª promise å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿé“¾å¼è°ƒç”¨ promiseã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾åé¢æ‰€æœ‰ç¤ºä¾‹éƒ½å·²ç»åƒè¿™æ ·å®‰è£…å¹¶åŠ è½½äº† request-promise ç±»åº“ï¼š 1var rp = require(&apos;request-promise&apos;); ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥åƒè¿™æ ·åˆ›å»ºä¸€ä¸ªè¿”å› promise å¯¹è±¡çš„ç®€æ˜“ HTTP GET è¯·æ±‚ï¼š 1const promise = rp(&apos;http://example.com/&apos;) æˆ‘ä»¬ç°åœ¨æ¥çœ‹ä¸ªä¾‹å­ï¼š 123console.log(&apos;Starting Execution&apos;);const promise = rp(&apos;http://example.com/&apos;);promise.then(result =&gt; console.log(result)); console.log(&quot;Can&apos;t know if promise has finished yet...&quot;); æˆ‘ä»¬åœ¨ç¬¬3è¡Œåˆ›å»ºäº†ä¸€ä¸ª promise å¯¹è±¡ï¼Œåœ¨ç¬¬4è¡Œç»™å®ƒåŠ äº†ä¸ªå›è°ƒå‡½æ•°ã€‚Promise æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥å½“æ‰§è¡Œåˆ°ç¬¬6è¡Œæ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ promise æ˜¯å¦å·²å®Œæˆã€‚å¦‚æœæŠŠæ®µè¿™ä»£ç å¤šæ‰§è¡Œå‡ æ¬¡ï¼Œå¯èƒ½æ¯æ¬¡éƒ½å¾—åˆ°ä¸åŒçš„ç»“æœã€‚ä¸€èˆ¬åœ°è¯´ï¼Œå°±æ˜¯ promise åˆ›å»ºåçš„ä»£ç å’Œ promise æ˜¯åŒæ—¶è¿è¡Œçš„ã€‚ ç›´åˆ° promise æ‰§è¡Œå®Œï¼Œæ‰æœ‰åŠæ³•é˜»å¡å½“å‰æ“ä½œåºåˆ—ã€‚è¿™ä¸åŒäº Java çš„ Future.get, å®ƒè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ Future ç»“æŸä¹‹å‰å°±é˜»å¡å½“å‰çº¿ç¨‹ã€‚å¯¹äº JavaScriptï¼Œæˆ‘ä»¬æ²¡æ³•ç­‰å¾… promise æ‰§è¡Œå®Œã€‚åœ¨ promise åé¢ç¼–æ’ä»£ç çš„å”¯ä¸€æ–¹æ³•æ˜¯ç”¨ then ç»™å®ƒæ·»åŠ å›è°ƒå‡½æ•°ã€‚ä¸‹å›¾æè¿°äº†æœ¬ä¾‹çš„è®¡ç®—è¿‡ç¨‹ï¼š Promise çš„è®¡ç®—è¿‡ç¨‹ã€‚æ­£åœ¨æ‰§è¡Œçš„â€œçº¿ç¨‹â€æ— æ³•ç­‰å¾… promise æ‰§è¡Œå®Œæˆã€‚åœ¨ promise åé¢ç¼–æ’ä»£ç çš„å”¯ä¸€æ–¹æ³•æ˜¯ç”¨ then ç»™å®ƒæ·»åŠ å›è°ƒå‡½æ•°ã€‚é€šè¿‡ then æ·»åŠ çš„å›è°ƒå‡½æ•°åªæœ‰å½“ promise æˆåŠŸæ—¶æ‰ä¼šæ‰§è¡Œã€‚å¦‚æœå®ƒå¤±è´¥äº†ï¼ˆæ¯”å¦‚ç”±äºç½‘ç»œé”™è¯¯ï¼‰ï¼Œå›è°ƒå‡½æ•°ä¸ä¼šæ‰§è¡Œã€‚ä½ å¯ä»¥ç”¨ catch å†é™„åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥å¤„ç†å¤±è´¥çš„ promise: 123rp(&apos;http://example.com/&apos;).then(() =&gt; console.log(&apos;Success&apos;)).catch(e =&gt; console.log(`Failed: ${e}`)) æœ€åï¼Œä¸ºäº†æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Promise.resolve å’Œ Promise.reject å¾ˆå®¹æ˜“åœ°åˆ›å»ºæ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥çš„â€œå‚»ç“œâ€ promise: 123456789101112const success = Promise.resolve(&apos;Resolved&apos;);// æ‰“å° &quot;Successful result: Resolved&quot;success. then(result =&gt; console.log(`Successful result: ${result}`)). catch(e =&gt; console.log(`Failed with: ${e}`)) const fail = Promise.reject(&apos;Err&apos;);// æ‰“å° &quot;Failed with: Err&quot;fail. then(result =&gt; console.log(`Successful result: ${result}`)). catch(e =&gt; console.log(`Failed with: ${e}`)) æƒ³è¦æ›´è¯¦ç»†çš„ promise æ•™ç¨‹ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ã€‚ é—®é¢˜æ¥äº†â€”â€”ç»„åˆpromiseåªç”¨ä¸€ä¸ª promise å¾ˆå®¹æ˜“æå®šã€‚ä½†æ˜¯ï¼Œå½“éœ€è¦é’ˆå¯¹å¤æ‚å¼‚æ­¥é€»è¾‘ç¼–ç¨‹æ—¶ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½æœ€åè¦åŒæ—¶ç”¨å¥½å‡ ä¸ª promise å¯¹è±¡ã€‚å†™ä¸€å † then è¯­å¥å’ŒåŒ¿åå›è°ƒå¾ˆå®¹æ˜“æå¾—éš¾ä»¥æ§åˆ¶ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦ç¼–ç¨‹è§£å†³å¦‚ä¸‹éœ€æ±‚ï¼šåˆ›å»º HTTP è¯·æ±‚ï¼Œç­‰å¾…è¯·æ±‚ç»“æŸå¹¶æ‰“å°å‡ºç»“æœï¼›å†åˆ›å»ºä¸¤ä¸ªå¹¶è¡Œ HTTP è¯·æ±‚ï¼›ç­‰è¿™ä¸¤ä¸ªè¯·æ±‚ç»“æŸåï¼Œæ‰“å°å‡ºå®ƒä»¬çš„ç»“æœã€‚ä¸‹é¢è¿™æ®µä»£ç ç¤ºèŒƒäº†å¦‚ä½•è§£å†³æ­¤é—®é¢˜ï¼š 123456789101112131415// ç¬¬ä¸€æ¬¡è°ƒç”¨const call1Promise = rp(&apos;http://example.com/&apos;); call1Promise.then(result1 =&gt; { // ç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆåä¼šæ‰§è¡Œ console.log(result1); const call2Promise = rp(&apos;http://example.com/&apos;); const call3Promise = rp(&apos;http://example.com/&apos;); return Promise.all([call2Promise, call3Promise]);}).then(arr =&gt; { // ä¸¤ä¸ª promise éƒ½ç»“æŸåä¼šæ‰§è¡Œ console.log(arr[0]); console.log(arr[1]);}) æˆ‘ä»¬å¼€å¤´åˆ›å»ºäº†ç¬¬ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶ä¸”åŠ äº†ä¸ªå®Œæˆæ—¶å€™è¿è¡Œçš„å›è°ƒï¼ˆ1-3è¡Œï¼‰ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°é‡Œï¼Œæˆ‘ä»¬ä¸ºéšåçš„ HTTP è¯·æ±‚åˆ›å»ºäº†å¦å¤–ä¸¤ä¸ª promiseï¼ˆ8-9è¡Œï¼‰ã€‚è¿™ä¸¤ä¸ª promise åŒæ—¶æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªèƒ½ç­‰å®ƒä»¬éƒ½å®Œæˆåæ‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ Promise.all å°†å®ƒä»¬ç»„åˆåˆ°åŒä¸€ä¸ª promise ä¸­ï¼ˆ11 è¡Œï¼‰ï¼Œå®ƒä»¬éƒ½ç»“æŸåè¿™ä¸ª promise æ‰ç®—å®Œæˆã€‚è¿™ä¸ªå›è°ƒè¿”å›çš„æ˜¯ promise å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å†åŠ ä¸€ä¸ª then å›è°ƒå‡½æ•°æ¥æ‰“å°ç»“æœï¼ˆ12-16è¡Œï¼‰ã€‚ä¸‹å›¾æè¿°äº†è¿™ä¸€è®¡ç®—æµç¨‹ï¼š Promise ç»„åˆçš„è®¡ç®—è¿‡ç¨‹ã€‚æˆ‘ä»¬ç”¨ Promise.all å°†ä¸¤ä¸ªå¹¶è¡Œçš„ promise ç»„åˆåˆ°ä¸€ä¸ª promise ä¸­ã€‚å¯¹äºè¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬æœ€åç”¨äº†ä¸¤ä¸ª then å›è°ƒæ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¾—ä¸ç”¨ Promise.all æ¥è®©ä¸¤ä¸ªå¹¶è¡Œçš„ promise åŒæ—¶æ‰§è¡Œã€‚å¦‚æœæˆ‘ä»¬å¿…é¡»æ‰§è¡Œæ›´å¤šå¼‚æ­¥æ“ä½œï¼Œæˆ–è€…åŠ ä¸Šé”™è¯¯å¤„ç†ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿè¿™ç§æ–¹æ³•æœ€åå¾ˆå®¹æ˜“äº§ç”Ÿä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„ then, Promise.all å’Œå›è°ƒå‡½æ•°ã€‚ Asyncæ–¹æ³•Async æ˜¯å®šä¹‰è¿”å› promise å¯¹è±¡å‡½æ•°çš„å¿«æ·æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸¤ç§å®šä¹‰æ˜¯ç­‰ä»·çš„ï¼š 12345678function f() { return Promise.resolve(&apos;TEST&apos;);} // asyncF å’Œ f æ˜¯ç­‰ä»·çš„async function asyncF() { return &apos;TEST&apos;;} Awaitæˆ‘ä»¬åˆ›å»ºäº† promise ä½†ä¸èƒ½åŒæ­¥ç­‰å¾…å®ƒæ‰§è¡Œå®Œæˆã€‚æˆ‘ä»¬åªèƒ½é€šè¿‡ then ä¼ ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ä¸å…è®¸ç­‰å¾… promise æ˜¯ä¸ºäº†é¼“åŠ±å¼€å‘éé˜»å¡ä»£ç ã€‚å¦åˆ™ï¼Œå¼€å‘è€…ä»¬æ€»ä¼šå¿ä¸ä½æ‰§è¡Œé˜»å¡æ“ä½œï¼Œå› ä¸ºé‚£æ¯”ä½¿ç”¨ promise å’Œå›è°ƒæ›´ç®€å•ã€‚ç„¶è€Œï¼Œä¸ºäº†è®© promise èƒ½åŒæ­¥æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦è®©ä»–ä»¬ç­‰å¾…å½¼æ­¤å®Œæˆã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªæ“ä½œæ˜¯å¼‚æ­¥çš„ï¼ˆå³å°è£…åœ¨ promise ä¸­ï¼‰ï¼Œå®ƒåº”è¯¥èƒ½å¤Ÿç­‰å¾…å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œã€‚ä½†æ˜¯ JavaScript è§£é‡Šå™¨æ€ä¹ˆèƒ½çŸ¥é“ä¸€ä¸ªæ“ä½œæ˜¯å¦åœ¨ promise ä¸­è¿è¡Œå‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨ async è¿™ä¸ªå…³é”®è¯ä¸­ã€‚æ¯ä¸ª async æ–¹æ³•éƒ½è¿”å›ä¸€ä¸ª promise å¯¹è±¡ã€‚å› æ­¤ï¼ŒJavaScript è§£é‡Šå™¨å°±æ˜ç™½æ‰€æœ‰ async æ–¹æ³•ä¸­çš„æ“ä½œéƒ½è¢«å°è£…åœ¨ promise é‡Œå¼‚æ­¥æ‰§è¡Œã€‚æ‰€ä»¥è§£é‡Šå™¨èƒ½å¤Ÿå…è®¸å®ƒä»¬ç­‰å¾…å…¶ä»– promise æ‰§è¡Œå®Œã€‚ä¸‹é¢å¼•å…¥ await å…³é”®è¯ã€‚å®ƒåªèƒ½è¢«ç”¨åœ¨ async æ–¹æ³•ä¸­ï¼Œè®©æˆ‘ä»¬èƒ½åŒæ­¥ç­‰å¾… promise æ‰§è¡Œå®Œã€‚å¦‚æœåœ¨ async å‡½æ•°å¤–ä½¿ç”¨ promise, æˆ‘ä»¬ä»ç„¶éœ€è¦ç”¨ then å›è°ƒå‡½æ•°ï¼š 123456789async function f(){ // response å°±æ˜¯ promise æ‰§è¡ŒæˆåŠŸçš„å€¼ const response = await rp(&apos;http://example.com/&apos;); console.log(response);} // ä¸èƒ½åœ¨ async æ–¹æ³•å¤–é¢ç”¨ await// éœ€è¦ä½¿ç”¨ then å›è°ƒå‡½æ•°â€¦â€¦f().then(() =&gt; console.log(&apos;Finished&apos;)); ç°åœ¨æˆ‘ä»¬æ¥çœ‹å¦‚ä½•è§£å†³ä¸Šä¸€èŠ‚çš„é—®é¢˜ï¼š 1234567891011121314151617181920212223// å°†è§£å†³æ–¹æ³•å°è£…åˆ° async å‡½æ•°ä¸­async function solution() { // ç­‰å¾…ç¬¬ä¸€ä¸ª HTTP è¯·æ±‚å¹¶æ‰“å°å‡ºç»“æœ console.log(await rp(&apos;http://example.com/&apos;)); // åˆ›å»ºä¸¤ä¸ª HTTP è¯·æ±‚ï¼Œä¸ç­‰å®ƒä»¬æ‰§è¡Œå®Œ â€”â€” è®©ä»–ä»¬åŒæ—¶æ‰§è¡Œ const call2Promise = rp(&apos;http://example.com/&apos;); // Does not wait! const call3Promise = rp(&apos;http://example.com/&apos;); // Does not wait! // åˆ›å»ºå®Œä»¥å â€”â€” ç­‰å¾…å®ƒä»¬éƒ½æ‰§è¡Œå®Œ const response2 = await call2Promise; const response3 = await call3Promise; console.log(response2); console.log(response3);} // è°ƒç”¨è¿™ä¸€ async å‡½æ•°solution().then(() =&gt; console.log(&apos;Finished&apos;)); ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠè§£å†³æ–¹æ³•å°è£…åˆ° async å‡½æ•°ä¸­ã€‚è¿™è®©æˆ‘ä»¬èƒ½ç›´æ¥å¯¹é‡Œé¢çš„ promise ä½¿ç”¨ await å…³é”®å­—ï¼Œæ‰€ä»¥ä¸å†éœ€è¦ä½¿ç”¨ then å›è°ƒå‡½æ•°ã€‚æœ€åï¼Œè°ƒç”¨è¿™ä¸ª async å‡½æ•°ï¼Œå®ƒç®€å•åœ°åˆ›å»ºäº†ä¸€ä¸ª promise å¯¹è±¡, è¿™ä¸ª promise å°è£…äº†è°ƒç”¨å…¶ä»– promise çš„é€»è¾‘ã€‚å½“ç„¶ï¼Œåœ¨ç¬¬ä¸€ä¸ªä¾‹å­ï¼ˆæ²¡æœ‰ç”¨ async / awaitï¼‰ä¸­ï¼Œä¸¤ä¸ª promiseä¼šè¢«åŒæ—¶è§¦å‘ã€‚è¿™æ®µä»£ç ä¹Ÿä¸€æ ·ï¼ˆ7-8 è¡Œï¼‰ã€‚æ³¨æ„ï¼Œç›´åˆ°ç¬¬ 11-12 è¡Œæˆ‘ä»¬æ‰ä½¿ç”¨ await, å°†ç¨‹åºä¸€ç›´é˜»å¡åˆ°ä¸¤ä¸ª promise æ‰§è¡Œå®Œæˆã€‚ç„¶åæˆ‘ä»¬å°±èƒ½æ–­å®šä¸Šä¾‹ä¸­ä¸¤ä¸ª promise éƒ½æˆåŠŸæ‰§è¡Œäº†ï¼ˆå’Œä½¿ç”¨ Promise.all(â€¦).then(â€¦) ç±»ä¼¼ï¼‰ã€‚è¿™èƒŒåçš„è®¡ç®—è¿‡ç¨‹è·Ÿä¸Šä¸€èŠ‚ç»™å‡ºçš„åŸºæœ¬ç›¸å½“ã€‚ä½†æ˜¯ä»£ç å¯è¯»æ€§æ›´å¼ºã€æ›´æ˜“äºç†è§£ã€‚å®é™…ä¸Šï¼Œasync / await åœ¨åº•å±‚è½¬æ¢æˆäº† promise å’Œ then å›è°ƒå‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä½¿ç”¨ promise çš„è¯­æ³•ç³–ã€‚æ¯æ¬¡æˆ‘ä»¬ä½¿ç”¨ await, è§£é‡Šå™¨éƒ½åˆ›å»ºä¸€ä¸ª promise å¯¹è±¡ï¼Œç„¶åæŠŠå‰©ä¸‹çš„ async å‡½æ•°ä¸­çš„æ“ä½œæ”¾åˆ° then å›è°ƒå‡½æ•°ä¸­ã€‚æˆ‘ä»¬å†çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š 12345async function f() { console.log(&apos;Starting F&apos;); const result = await rp(&apos;http://example.com/&apos;); console.log(result);} ä¸‹é¢ç»™å‡ºäº†å‡½æ•° f åº•å±‚è¿ç®—è¿‡ç¨‹ã€‚ç”±äº f æ˜¯ async çš„ï¼Œæ‰€ä»¥å®ƒä¼šè·Ÿå®ƒçš„è°ƒç”¨æ–¹åŒæ—¶æ‰§è¡Œï¼š å‡½æ•° f å¼€å§‹è¿è¡Œå¹¶åˆ›å»ºäº†ä¸€ä¸ª promise å¯¹è±¡ã€‚å°±åœ¨é‚£ä¸€åˆ»ï¼Œå‡½æ•°ä¸­å‰©ä¸‹çš„éƒ¨åˆ†è¢«å°è£…åˆ°ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œå¹¶åœ¨ promise ç»“æŸåæ‰§è¡Œã€‚ é”™è¯¯å¤„ç†å‰é¢å¤§éƒ¨åˆ†ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éƒ½å‡è®¾ promise æ‰§è¡ŒæˆåŠŸã€‚å› æ­¤åœ¨ promise ä¸Šä½¿ç”¨ await ä¼šè¿”å›å€¼ã€‚å¦‚æœæˆ‘ä»¬è¿›è¡Œ await çš„ promise å¤±è´¥äº†ï¼Œasync å‡½æ•°å°±ä¼šå‘ç”Ÿå¼‚å¸¸ã€‚æˆ‘ä»¬å¯ä»¥ç”¨æ ‡å‡†çš„ try / catch æ¥å¤„ç†è¿™ç§æƒ…å†µï¼š 1234567async function f() { try { const promiseResult = await Promise.reject(&apos;Error&apos;); } catch (e){ console.log(e); }} Async å‡½æ•°ä¸ä¼šå¤„ç†å¼‚å¸¸ï¼Œä¸ç®¡å¼‚å¸¸æ˜¯ç”±æ‹’ç»çš„ promise è¿˜æ˜¯å…¶ä»– bug å¼•èµ·çš„ï¼Œå®ƒéƒ½ä¼šè¿”å›ä¸€ä¸ªæ‹’ç» promise: 123456789101112131415161718async function f() { // Throws an exception const promiseResult = await Promise.reject(&apos;Error&apos;);} // Will print &quot;Error&quot;f(). then(() =&gt; console.log(&apos;Success&apos;)). catch(err =&gt; console.log(err)) async function g() { throw &quot;Error&quot;;} // Will print &quot;Error&quot;g(). then(() =&gt; console.log(&apos;Success&apos;)). catch(err =&gt; console.log(err)) è¿™è®©æˆ‘ä»¬èƒ½å¾—å¿ƒåº”æ‰‹åœ°é€šè¿‡ç†Ÿæ‚‰çš„å¼‚å¸¸å¤„ç†æœºåˆ¶æ¥å¤„ç†æ‹’ç»çš„ promise. è®¨è®ºAsync / await æ˜¯è®© promise æ›´å®Œç¾çš„è¯­è¨€ç»“æ„ã€‚å®ƒè®©æˆ‘ä»¬èƒ½ç”¨æ›´å°‘çš„ä»£ç ä½¿ç”¨ promise. ç„¶è€Œï¼Œasync / await å¹¶æ²¡æœ‰å–ä»£æ™®é€š promise. ä¾‹å¦‚ï¼Œå¦‚æœåœ¨æ™®é€šå‡½æ•°ä¸­æˆ–è€…å…¨å±€èŒƒå›´å†…è°ƒç”¨ async å‡½æ•°ï¼Œæˆ‘ä»¬å°±æ²¡åŠæ³•ä½¿ç”¨ await è€Œè¦ä¾èµ–äºæ™®é€š promise: 1234567async function fAsync() { // actual return value is Promise.resolve(5) return 5;} // can&apos;t call &quot;await fAsync()&quot;. Need to use then/catchfAsync().then(r =&gt; console.log(`result is ${r}`)); æˆ‘é€šå¸¸ä¼šå°†å¤§éƒ¨åˆ†å¼‚æ­¥é€»è¾‘å°è£…åˆ°ä¸€ä¸ªæˆ–è€…å‡ ä¸ª async å‡½æ•°ä¸­ï¼Œç„¶ååœ¨éå¼‚æ­¥ä»£ç ä¸­è°ƒç”¨ã€‚è¿™è®©æˆ‘å°½å¯èƒ½å°‘åœ°å†™ try / catch å›è°ƒã€‚Async / await ç»“æ„æ˜¯è®©ä½¿ç”¨ promise æ›´ç®€ç»ƒçš„è¯­æ³•ç³–ã€‚æ¯ä¸€ä¸ª async / await ç»“æ„éƒ½å¯ä»¥å†™æˆæ™®é€š promise. å½’æ ¹ç»“åº•ï¼Œè¿™æ˜¯ä¸€ä¸ªç¼–ç é£æ ¼å’Œç®€æ´çš„é—®é¢˜ã€‚å…³äºè¯´æ˜å¹¶å‘å’Œå¹¶è¡Œæœ‰åŒºåˆ«çš„èµ„æ–™ï¼Œå¯ä»¥æŸ¥çœ‹ Rob Pike å…³äºè¿™ä¸ªé—®é¢˜çš„è®¨è®ºï¼Œæˆ–è€…æˆ‘è¿™ç¯‡æ–‡ç« ã€‚å¹¶å‘æ˜¯æŒ‡å°†ç‹¬ç«‹è¿›ç¨‹ï¼ˆé€šå¸¸æ„ä¹‰ä¸Šçš„è¿›ç¨‹ï¼‰ç»„åˆåœ¨ä¸€èµ·å·¥ä½œï¼Œè€Œå¹¶è¡Œæ˜¯æŒ‡çœŸæ­£åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚å¹¶å‘å…³ä¹åº”ç”¨è®¾è®¡å’Œæ¶æ„ï¼Œè€Œå¹¶è¡Œå…³ä¹å®å®åœ¨åœ¨çš„æ‰§è¡Œã€‚æˆ‘ä»¬æ‹¿ä¸€ä¸ªå¤šçº¿ç¨‹åº”ç”¨æ¥ä¸¾ä¾‹ã€‚åº”ç”¨ç¨‹åºåˆ†ç¦»æˆçº¿ç¨‹æ˜ç¡®äº†å®ƒçš„å¹¶å‘æ¨¡å‹ã€‚è¿™äº›çº¿ç¨‹åœ¨å¯ç”¨å†…æ ¸ä¸Šçš„æ˜ å°„å®šä¹‰äº†å…¶çº§åˆ«æˆ–å¹¶è¡Œæ€§ã€‚å¹¶å‘ç³»ç»Ÿå¯ä»¥åœ¨å•ä¸ªå¤„ç†å™¨ä¸Šé«˜æ•ˆè¿è¡Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå¹¶ä¸æ˜¯å¹¶è¡Œçš„ã€‚ å¹¶å‘VSå¹¶è¡Œï¼š ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼Œpromise è®©æˆ‘ä»¬èƒ½å¤Ÿå°†ç¨‹åºåˆ†è§£æˆå¹¶å‘æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šå¹¶è¡Œæ‰§è¡Œã€‚Javascript å®é™…å¦å¹¶è¡Œæ‰§è¡Œå–å†³äºå…·ä½“å®ç°æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒNode JS æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœ promise æ˜¯è®¡ç®—å¯†é›†å‹ï¼ˆCPU boundï¼‰é‚£å°±ä¸ä¼šæœ‰å¹¶è¡Œå¤„ç†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ç”¨ Nashorn ä¹‹ç±»çš„ä¸œè¥¿æŠŠä»£ç ç¼–è¯‘æˆ java å­—èŠ‚ç ï¼Œç†è®ºä¸Šå¯èƒ½èƒ½å¤Ÿå°†è®¡ç®—å¯†é›†å‹çš„ promise æ˜ å°„åˆ°ä¸åŒ CPU æ ¸ä¸Šï¼Œä»è€Œè¾¾åˆ°å¹¶è¡Œæ•ˆæœã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºï¼Œpromiseï¼ˆä¸ç®¡æ˜¯æ™®é€šçš„è¿˜æ˜¯ç”¨äº† async / await çš„ï¼‰ç»„æˆäº† JavaScript åº”ç”¨çš„å¹¶å‘æ¨¡å—ã€‚","link":"/2019/07/08/ç”¨å›¾è¡¨å’Œå®ä¾‹è§£é‡ŠAsyncå’ŒAwait/"},{"title":"ReactNativeæ ·å¼æ€»ç»“","text":"ReactNativeçš„æ ·å¼è·ŸåŸç”ŸCSSæ ·å¼æœ‰ä¸€å®šåŒºåˆ«ï¼Œä¸”ä¸æ”¯æŒéƒ¨åˆ†åŸç”ŸCSSæ ·å¼ï¼Œä¸‹é¢æ˜¯å¯¹RNå¸¸ç”¨æ ·å¼çš„æ€»ç»“ï¼š ReactNativeä¸­æ ·å¼é‡‡ç”¨é©¼å³°å†™æ³• Viewç»„ä»¶ç±»ä¼¼Divæ ‡ç­¾ï¼ŒåŒ…è£…å®¹å™¨ï¼Œé»˜è®¤å ç”¨100%å®½åº¦ï¼Œæ˜¯æœ€å¸¸ç”¨çš„å—çŠ¶å…ƒç´  Textç»„ä»¶ç±»ä¼¼Spanæ ‡ç­¾ï¼Œåœ¨è¢«ViewåŒ…è£¹æ—¶å€™å¯è®¾ç½®paddingã€marginåƒå—çŠ¶ ç»å¯¹å®šä½å’Œç›¸å¯¹å®šä½çˆ¶å…ƒç´ ä¸éœ€è¦è®¾ç½®positionå’Œzindex é»˜è®¤æ˜¯Flexå¸ƒå±€ï¼Œæ–¹å‘æ˜¯è‡ªä¸Šè€Œä¸‹ å¸¸ç”¨å±æ€§Text æ–‡æœ¬ å±æ€§å å–å€¼ æè¿° color é¢œè‰² å¯¹åº” CSS ä¸­çš„ color å±æ€§ fontFamily string å¯¹åº” CSS ä¸­çš„ font-family å±æ€§ fontSize number å¯¹åº” CSS ä¸­çš„ font-size å±æ€§ fontStyle normal, italic å¯¹åº” CSS ä¸­çš„ font-style å±æ€§ï¼Œä½†é˜‰å‰²äº† oblique å–å€¼ fontWeight normal, bold 100~900 å¯¹åº” CSS ä¸­çš„ font-weight å±æ€§ï¼Œä½†é˜‰å‰²äº† bolder, lighter å–å€¼ lineHeight number å¯¹åº” CSS ä¸­çš„ line-height å±æ€§ textAlign auto, left, right, center, justify å¯¹åº” CSS ä¸­çš„ text-align å±æ€§ï¼Œå¢åŠ äº† auto å–å€¼ï¼Œå½“å–å€¼ä¸º justify æ—¶ï¼Œåœ¨ Android ä¸Šä¼šå˜ä¸º left textAlignVerticalAndroid auto, top, bottom, center å¯¹åº” CSS ä¸­çš„ vertical-align å±æ€§ï¼Œå¢åŠ äº† auto å–å€¼ï¼Œcenter å–ä»£äº† middleï¼Œå¹¶é˜‰å‰²äº† baseline, subç­‰å€¼ includeFontPaddingAndroid boolean Androidåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä¸ºæ–‡å­—é¢å¤–ä¿ç•™ä¸€äº›paddingï¼Œä»¥ä¾¿ç•™å‡ºç©ºé—´æ‘†æ”¾ä¸Šæ ‡æˆ–æ˜¯ä¸‹æ ‡çš„æ–‡å­—ã€‚å¯¹äºæŸäº›å­—ä½“æ¥è¯´ï¼Œè¿™äº›é¢å¤–çš„paddingå¯èƒ½ä¼šå¯¼è‡´æ–‡å­—éš¾ä»¥å‚ç›´å±…ä¸­ã€‚å¦‚æœä½ æŠŠtextAlignVerticalè®¾ç½®ä¸ºcenterä¹‹åï¼Œæ–‡å­—çœ‹èµ·æ¥ä¾ç„¶ä¸åœ¨æ­£ä¸­é—´ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•å°†æœ¬å±æ€§è®¾ç½®ä¸ºfalse textShadowColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ text-shadow å±æ€§ä¸­çš„é¢œè‰²å®šä¹‰ textShadowOffset { width: number, height: number } å¯¹åº” CSS ä¸­çš„ text-shadow å±æ€§ä¸­çš„é˜´å½±åç§»å®šä¹‰ textShadowRadius number åœ¨ CSS ä¸­ï¼Œé˜´å½±çš„åœ†è§’å¤§å°å–å†³äºå…ƒç´ çš„åœ†è§’å®šä¹‰ï¼Œä¸éœ€è¦é¢å¤–å®šä¹‰ letterSpacingiOS number å¯¹åº” CSS ä¸­çš„ letter-spacing å±æ€§ï¼Œä½†å–å€¼ä¸åŒ textDecorationColoriOS é¢œè‰² å¯¹åº” CSS ä¸­çš„ text-decoration-color å±æ€§ textDecorationLineiOS none, underline, line-through, underline line-through å¯¹åº” CSS ä¸­çš„ text-decoration-line å±æ€§ï¼Œä½†é˜‰å‰²äº† overline, blink å–å€¼ textDecorationStyleiOS solid, double, dotted, dashed å¯¹åº” CSS ä¸­çš„ text-decoration-style å±æ€§ï¼Œä½†é˜‰å‰²äº† wavy å–å€¼ writingDirectioniOS auto, ltr, rtl å¯¹åº” CSS ä¸­çš„ direction å±æ€§ï¼Œå¢åŠ äº† auto å–å€¼ Dimension å®½é«˜ å±æ€§å å–å€¼ æè¿° width number å¯¹åº” CSS ä¸­çš„ width å±æ€§ height number å¯¹åº” CSS ä¸­çš„ height å±æ€§ Positioning å®šä½ å±æ€§å å–å€¼ æè¿° position absolute, relative å¯¹åº” CSS ä¸­çš„ position å±æ€§ï¼Œä½†é˜‰å‰²äº† static, fixed å–å€¼ top number å¯¹åº” CSS ä¸­çš„ top å±æ€§ right number å¯¹åº” CSS ä¸­çš„ right å±æ€§ bottom number å¯¹åº” CSS ä¸­çš„ bottom å±æ€§ left number å¯¹åº” CSS ä¸­çš„ left å±æ€§ Margin å±æ€§å å–å€¼ æè¿° margin number å¯¹åº” CSS ä¸­çš„ margin å±æ€§ï¼Œä¸åŒçš„æ˜¯ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªå‚æ•°ï¼Œç”¨ä»¥è¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦4ä¸ªæ–¹ä½çš„å¤–è¡¥ç™½ marginHorizontal number CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®marginRightå’ŒmarginLeft marginVertical number CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®marginTopå’ŒmarginBottom marginTop number å¯¹åº” CSS ä¸­çš„ margin-top å±æ€§ marginRight number å¯¹åº” CSS ä¸­çš„ margin-right å±æ€§ marginBottom number å¯¹åº” CSS ä¸­çš„ margin-bottom å±æ€§ marginLeft number å¯¹åº” CSS ä¸­çš„ margin-left å±æ€§ Padding å±æ€§å å–å€¼ æè¿° padding number å¯¹åº” CSS ä¸­çš„ padding å±æ€§ï¼Œä¸åŒçš„æ˜¯ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªå‚æ•°ï¼Œç”¨ä»¥è¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦4ä¸ªæ–¹ä½çš„å†…è¡¥ç™½ paddingHorizontal number CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®paddingRightå’ŒpaddingLeft paddingVertical number CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œç›¸å½“äºåŒæ—¶è®¾ç½®paddingTopå’ŒpaddingBottom paddingTop number å¯¹åº” CSS ä¸­çš„ padding-top å±æ€§ paddingRight number å¯¹åº” CSS ä¸­çš„ padding-right å±æ€§ paddingBottom number å¯¹åº” CSS ä¸­çš„ padding-bottom å±æ€§ paddingLeft number å¯¹åº” CSS ä¸­çš„ padding-left å±æ€§ Border å±æ€§å å–å€¼ æè¿° borderStyle solid, dotted, dashed å¯¹åº” CSS ä¸­çš„ border-style å±æ€§ï¼Œä½†é˜‰å‰²äº† none, hidden, double, groove, ridge, inset, outset å–å€¼ï¼Œä¸”æ— æ–¹å‘åˆ†æ‹†å±æ€§ borderWidth number å¯¹åº” CSS ä¸­çš„ border-width å±æ€§ borderTopWidth number å¯¹åº” CSS ä¸­çš„ border-top-width å±æ€§ borderRightWidth number å¯¹åº” CSS ä¸­çš„ border-right-width å±æ€§ borderBottomWidth number å¯¹åº” CSS ä¸­çš„ border-bottom-width å±æ€§ borderLeftWidth number å¯¹åº” CSS ä¸­çš„ border-left-width å±æ€§ borderColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ border-color å±æ€§ borderTopColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ border-top-color å±æ€§ borderRightColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ border-right-color å±æ€§ borderBottomColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ border-bottom-color å±æ€§ borderLeftColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ border-left-color å±æ€§ borderRadius number å¯¹åº” CSS ä¸­çš„ border-radius å±æ€§ borderTopLeftRadius number å¯¹åº” CSS ä¸­çš„ border-top-left-radius å±æ€§ borderTopRightRadius number å¯¹åº” CSS ä¸­çš„ border-top-right-radius å±æ€§ borderBottomLeftRadius number å¯¹åº” CSS ä¸­çš„ border-bottom-left-radius å±æ€§ borderBottomRightRadius number å¯¹åº” CSS ä¸­çš„ border-bottom-right-radius å±æ€§ Shadow å±æ€§å å–å€¼ æè¿° shadowColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ box-shadow å±æ€§ä¸­çš„é¢œè‰²å®šä¹‰ shadowOffset { width: number, height: number } å¯¹åº” CSS ä¸­çš„ box-shadow å±æ€§ä¸­çš„é˜´å½±åç§»å®šä¹‰ shadowRadius number åœ¨ CSS ä¸­ï¼Œé˜´å½±çš„åœ†è§’å¤§å°å–å†³äºå…ƒç´ çš„åœ†è§’å®šä¹‰ï¼Œä¸éœ€è¦é¢å¤–å®šä¹‰ shadowOpacity number å¯¹åº” CSS ä¸­çš„ box-shadow å±æ€§ä¸­çš„é˜´å½±é€æ˜åº¦å®šä¹‰ Background èƒŒæ™¯ å±æ€§å å–å€¼ æè¿° backgroundColor é¢œè‰² å¯¹åº” CSS ä¸­çš„ background-color å±æ€§ Transform å±æ€§å å–å€¼ æè¿° transform [{perspective: number}, {rotate: string}, {rotateX: string}, {rotateY: string}, {rotateZ: string}, {scale: number}, {scaleX: number}, {scaleY: number}, {translateX: number}, {translateY: number}, {skewX: string}, {skewY: string}] å¯¹åº” CSS ä¸­çš„ transform å±æ€§ transformMatrix TransformMatrixPropType ç±»ä¼¼äº CSS ä¸­ transform å±æ€§çš„ matrix() å’Œ matrix3d() å‡½æ•° backfaceVisibility visible, hidden å¯¹åº” CSS ä¸­çš„ backface-visibility å±æ€§ Flex å±æ€§å å–å€¼ æè¿° flex number å¯¹åº” CSS ä¸­çš„ flex å±æ€§ flexGrow number è®¾ç½®æˆ–æ£€ç´¢å¼¹æ€§ç›’çš„æ‰©å±•æ¯”ç‡ flexShrink number å°†å­å…ƒç´ å®½åº¦ä¹‹å’Œä¸çˆ¶å…ƒç´ å®½åº¦çš„å·®å€¼æŒ‰ç…§å­å…ƒç´  flex-shrink çš„å€¼åˆ†é…ç»™å„ä¸ªå­å…ƒç´ ï¼Œæ¯ä¸ªå­å…ƒç´ åŸæœ¬å®½åº¦å‡å»æŒ‰æ¯”ä¾‹åˆ†é…çš„å€¼ï¼Œå…¶å‰©ä½™å€¼ä¸ºå®é™…å®½åº¦ã€‚ flexBasis number è®¾ç½®æˆ–æ£€ç´¢å¼¹æ€§ç›’ä¼¸ç¼©åŸºå‡†å€¼ flexDirection row, column å¯¹åº” CSS ä¸­çš„ flex-direction å±æ€§ï¼Œä½†é˜‰å‰²äº† row-reverse, column-reverse å–å€¼ flexWrap wrap, nowrap å¯¹åº” CSS ä¸­çš„ flex-wrap å±æ€§ï¼Œä½†é˜‰å‰²äº† wrap-reverse å–å€¼ justifyContent flex-start, flex-end, center, space-between, space-around å¯¹åº” CSS ä¸­çš„ justify-content å±æ€§ï¼Œä½†é˜‰å‰²äº† stretch å–å€¼ã€‚ alignItems flex-start, flex-end, center, stretch å¯¹åº” CSS ä¸­çš„ align-items å±æ€§ï¼Œä½†é˜‰å‰²äº† baseline å–å€¼ã€‚ alignSelf auto, flex-start, flex-end, center, stretch å¯¹åº” CSS ä¸­çš„ align-self å±æ€§ï¼Œä½†é˜‰å‰²äº† baseline å–å€¼ å…¶ä»– å±æ€§å å–å€¼ æè¿° opacity number å¯¹åº” CSS ä¸­çš„ opacity å±æ€§ overflow visible, hidden å¯¹åº” CSS ä¸­çš„ overflow å±æ€§ï¼Œä½†é˜‰å‰²äº† scroll, auto å–å€¼ number å¯¹åº” CSS ä¸­çš„ z-index å±æ€§ elevationAndroid number CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œåªåœ¨ Android5.0+ ä¸Šæœ‰æ•ˆ resizeMode cover, contain, stretch CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œå¯ä»¥å‚è€ƒ background-size å±æ€§ overlayColorAndroid string CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼Œå½“å›¾åƒæœ‰åœ†è§’æ—¶ï¼Œå°†è§’è½éƒ½å……æ»¡ä¸€ç§é¢œè‰² tintColoriOS é¢œè‰² CSSä¸­æ²¡æœ‰å¯¹åº”çš„å±æ€§ï¼ŒiOS å›¾åƒä¸Šç‰¹æ®Šçš„è‰²å½©ï¼Œæ”¹å˜ä¸é€æ˜åƒç´ çš„é¢œè‰² é¢œè‰²å–å€¼React-Native æ”¯æŒäº† CSS ä¸­å¤§éƒ¨åˆ†çš„é¢œè‰²ç±»å‹ï¼š #f00 (#rgb) #f00c (#rgba)ï¼šCSS ä¸­æ— å¯¹åº”çš„å€¼ #ff0000 (#rrggbb) #ff0000cc (#rrggbbaa)ï¼šCSS ä¸­æ— å¯¹åº”çš„å€¼ rgb(255, 0, 0) rgba(255, 0, 0, 0.9) hsl(360, 100%, 100%) hsla(360, 100%, 100%, 0.9) transparent Color Nameï¼šæ”¯æŒäº† åŸºæœ¬é¢œè‰²å…³é”®å­— å’Œ æ‹“å±•é¢œè‰²å…³é”®å­—ï¼Œä½†ä¸æ”¯æŒ 28ä¸ªç³»ç»Ÿé¢œè‰²ï¼› Units å•ä½åœ¨ React-Native ä¸­ï¼Œå¹¶ä¸æ”¯æŒç™¾åˆ†æ¯”å•ä½ï¼Œç›®å‰åªæ”¯æŒä¸€ç§å•ä½ï¼Œå³ pt ç»å¯¹é•¿åº¦å•ä½ï¼ŒåŒæ—¶ï¼Œä½ åœ¨å®šä¹‰æ—¶ä¸éœ€è¦åŠ å•ä½ï¼Œä¾‹å¦‚ï¼š 1234567&lt;View style={{width: 100, height: 50}}&gt;&lt;/View&gt;var styles = StyleSheet.create({ box: { width: 100, height: 50 }});","link":"/2019/07/02/ReactNativeæ ·å¼æ€»ç»“/"},{"title":"Ajaxå’ŒXMLHttpRequest","text":"Ajaxå’ŒXMLHttpRequestæˆ‘ä»¬é€šå¸¸å°†Ajaxç­‰åŒäºXMLHttpRequestï¼Œä½†ç»†ç©¶èµ·æ¥å®ƒä»¬ä¸¤ä¸ªæ˜¯å±äºä¸åŒç»´åº¦çš„2ä¸ªæ¦‚å¿µã€‚ ä»¥ä¸‹æ˜¯æˆ‘è®¤ä¸ºå¯¹Ajaxè¾ƒä¸ºå‡†ç¡®çš„è§£é‡Šï¼šï¼ˆæ‘˜è‡ªwhat is Ajaxï¼‰AJAX stands for Asynchronous JavaScript and XML. AJAX is a new technique for creating better, faster, and more interactive web applications with the help of XML, HTML, CSS, and Java Script. AJAX is based on the following open standards: Browser-based presentation using HTML and Cascading Style Sheets (CSS). Data is stored in XML format and fetched from the server. Behind-the-scenes data fetches using XMLHttpRequest objects in the browser. JavaScript to make everything happen. ä»ä¸Šé¢çš„è§£é‡Šä¸­å¯ä»¥çŸ¥é“ï¼šajaxæ˜¯ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆï¼Œä½†å¹¶ä¸æ˜¯ä¸€ç§æ–°æŠ€æœ¯ã€‚å®ƒä¾èµ–çš„æ˜¯ç°æœ‰çš„CSS/HTML/Javascriptï¼Œè€Œå…¶ä¸­æœ€æ ¸å¿ƒçš„ä¾èµ–æ˜¯æµè§ˆå™¨æä¾›çš„XMLHttpRequestå¯¹è±¡ï¼Œæ˜¯è¿™ä¸ªå¯¹è±¡ä½¿å¾—æµè§ˆå™¨å¯ä»¥å‘å‡ºHTTPè¯·æ±‚ä¸æ¥æ”¶HTTPå“åº”ã€‚ æ‰€ä»¥æˆ‘ç”¨ä¸€å¥è¯æ¥æ€»ç»“ä¸¤è€…çš„å…³ç³»ï¼šæˆ‘ä»¬ä½¿ç”¨XMLHttpRequestå¯¹è±¡æ¥å‘é€ä¸€ä¸ªAjaxè¯·æ±‚ã€‚ XMLHttpRequestçš„å‘å±•å†ç¨‹XMLHttpRequestä¸€å¼€å§‹åªæ˜¯å¾®è½¯æµè§ˆå™¨æä¾›çš„ä¸€ä¸ªæ¥å£ï¼Œåæ¥å„å¤§æµè§ˆå™¨çº·çº·æ•ˆä»¿ä¹Ÿæä¾›äº†è¿™ä¸ªæ¥å£ï¼Œå†åæ¥W3Cå¯¹å®ƒè¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œæå‡ºäº†XMLHttpRequestæ ‡å‡†ã€‚XMLHttpRequestæ ‡å‡†åˆåˆ†ä¸ºLevel 1å’ŒLevel 2ã€‚XMLHttpRequest Level 1ä¸»è¦å­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š å—åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œä¸èƒ½å‘é€è·¨åŸŸè¯·æ±‚ï¼› ä¸èƒ½å‘é€äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰ï¼‰ï¼Œåªèƒ½å‘é€çº¯æ–‡æœ¬æ•°æ®ï¼› åœ¨å‘é€å’Œè·å–æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œæ— æ³•å®æ—¶è·å–è¿›åº¦ä¿¡æ¯ï¼Œåªèƒ½åˆ¤æ–­æ˜¯å¦å®Œæˆï¼› é‚£ä¹ˆLevel 2å¯¹Level 1 è¿›è¡Œäº†æ”¹è¿›ï¼ŒXMLHttpRequest Level 2ä¸­æ–°å¢äº†ä»¥ä¸‹åŠŸèƒ½ï¼š å¯ä»¥å‘é€è·¨åŸŸè¯·æ±‚ï¼Œåœ¨æœåŠ¡ç«¯å…è®¸çš„æƒ…å†µä¸‹ï¼› æ”¯æŒå‘é€å’Œæ¥æ”¶äºŒè¿›åˆ¶æ•°æ®ï¼› æ–°å¢formDataå¯¹è±¡ï¼Œæ”¯æŒå‘é€è¡¨å•æ•°æ®ï¼› å‘é€å’Œè·å–æ•°æ®æ—¶ï¼Œå¯ä»¥è·å–è¿›åº¦ä¿¡æ¯ï¼› å¯ä»¥è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼› å½“ç„¶æ›´è¯¦ç»†çš„å¯¹æ¯”ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒé˜®è€å¸ˆçš„è¿™ç¯‡æ–‡ç« ï¼Œæ–‡ç« ä¸­å¯¹æ–°å¢çš„åŠŸèƒ½éƒ½æœ‰å…·ä½“ä»£ç ç¤ºä¾‹ã€‚ XMLHttpRequestå…¼å®¹æ€§å…³äºXMLHttpRequestçš„æµè§ˆå™¨å…¼å®¹æ€§ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥æŸ¥çœ‹â€œCan I useâ€è¿™ä¸ªç½‘ç«™æä¾›çš„ç»“æœï¼š IE8/IE9ã€Opera Mini å®Œå…¨ä¸æ”¯æŒxhrå¯¹è±¡ IE10/IE11éƒ¨åˆ†æ”¯æŒï¼Œä¸æ”¯æŒ xhr.responseTypeä¸ºjson éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒè®¾ç½®è¯·æ±‚è¶…æ—¶ï¼Œå³æ— æ³•ä½¿ç”¨xhr.timeout éƒ¨åˆ†æµè§ˆå™¨ä¸æ”¯æŒxhr.responseTypeä¸ºblob ç»†è¯´XMLHttpRequestå¦‚ä½•ä½¿ç”¨å…ˆæ¥çœ‹ä¸€æ®µä½¿ç”¨XMLHttpRequestå‘é€Ajaxè¯·æ±‚çš„ç®€å•ç¤ºä¾‹ä»£ç ã€‚ 1234567891011121314151617181920212223242526function sendAjax() { //æ„é€ è¡¨å•æ•°æ® var formData = new FormData(); formData.append(&apos;username&apos;, &apos;johndoe&apos;); formData.append(&apos;id&apos;, 123456); //åˆ›å»ºxhrå¯¹è±¡ var xhr = new XMLHttpRequest(); //è®¾ç½®xhrè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ xhr.timeout = 3000; //è®¾ç½®å“åº”è¿”å›çš„æ•°æ®æ ¼å¼ xhr.responseType = &quot;text&quot;; //åˆ›å»ºä¸€ä¸ª post è¯·æ±‚ï¼Œé‡‡ç”¨å¼‚æ­¥ xhr.open(&apos;POST&apos;, &apos;/server&apos;, true); //æ³¨å†Œç›¸å…³äº‹ä»¶å›è°ƒå¤„ç†å‡½æ•° xhr.onload = function(e) { if(this.status == 200||this.status == 304){ alert(this.responseText); } }; xhr.ontimeout = function(e) { ... }; xhr.onerror = function(e) { ... }; xhr.upload.onprogress = function(e) { ... }; //å‘é€æ•°æ® xhr.send(formData);} ä¸Šé¢æ˜¯ä¸€ä¸ªä½¿ç”¨xhrå‘é€è¡¨å•æ•°æ®çš„ç¤ºä¾‹ï¼Œæ•´ä¸ªæµç¨‹å¯ä»¥å‚è€ƒæ³¨é‡Šã€‚ æ¥ä¸‹æ¥æˆ‘å°†ç«™åœ¨ä½¿ç”¨è€…çš„è§’åº¦ï¼Œä»¥é—®é¢˜çš„å½¢å¼ä»‹ç»xhrçš„åŸºæœ¬ä½¿ç”¨ã€‚æˆ‘å¯¹æ¯ä¸€ä¸ªé—®é¢˜æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹éƒ½ä¼šè¿›è¡Œæ¯”è¾ƒç»†è‡´åœ°ä»‹ç»ï¼Œæœ‰äº›çŸ¥è¯†ç‚¹å¯èƒ½æ˜¯ä½ å¹³æ—¶å¿½ç•¥å…³æ³¨çš„ã€‚ å¦‚ä½•è®¾ç½®request headeråœ¨å‘é€Ajaxè¯·æ±‚ï¼ˆå®è´¨æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼‰æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è®¾ç½®ä¸€äº›è¯·æ±‚å¤´éƒ¨ä¿¡æ¯ï¼Œæ¯”å¦‚content-typeã€connectionã€cookieã€accept-xxxç­‰ã€‚xhræä¾›äº†setRequestHeaderæ¥å…è®¸æˆ‘ä»¬ä¿®æ”¹è¯·æ±‚ headerã€‚ 12&gt; void setRequestHeader(DOMString header, DOMString value);&gt; æ³¨æ„ç‚¹ï¼š æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•° header å¤§å°å†™ä¸æ•æ„Ÿï¼Œå³å¯ä»¥å†™æˆcontent-typeï¼Œä¹Ÿå¯ä»¥å†™æˆContent-Typeï¼Œç”šè‡³å†™æˆcontent-Type; Content-Typeçš„é»˜è®¤å€¼ä¸å…·ä½“å‘é€çš„æ•°æ®ç±»å‹æœ‰å…³ï¼Œè¯·å‚è€ƒæœ¬æ–‡ã€å¯ä»¥å‘é€ä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‘ä¸€èŠ‚ï¼› setRequestHeaderå¿…é¡»åœ¨open()æ–¹æ³•ä¹‹åï¼Œsend()æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå¦åˆ™ä¼šæŠ›é”™ï¼› setRequestHeaderå¯ä»¥è°ƒç”¨å¤šæ¬¡ï¼Œæœ€ç»ˆçš„å€¼ä¸ä¼šé‡‡ç”¨è¦†ç›–overrideçš„æ–¹å¼ï¼Œè€Œæ˜¯é‡‡ç”¨è¿½åŠ appendçš„æ–¹å¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š 123456var client = new XMLHttpRequest();client.open(&apos;GET&apos;, &apos;demo.cgi&apos;);client.setRequestHeader(&apos;X-Test&apos;, &apos;one&apos;);client.setRequestHeader(&apos;X-Test&apos;, &apos;two&apos;);// æœ€ç»ˆrequest headerä¸­&quot;X-Test&quot;ä¸º: one, twoclient.send(); å¦‚ä½•è·å–response headerxhræä¾›äº†2ä¸ªç”¨æ¥è·å–å“åº”å¤´éƒ¨çš„æ–¹æ³•ï¼šgetAllResponseHeaderså’ŒgetResponseHeaderã€‚å‰è€…æ˜¯è·å– response ä¸­çš„æ‰€æœ‰header å­—æ®µï¼Œåè€…åªæ˜¯è·å–æŸä¸ªæŒ‡å®š header å­—æ®µçš„å€¼ã€‚å¦å¤–ï¼ŒgetResponseHeader(header)çš„headerå‚æ•°ä¸åŒºåˆ†å¤§å°å†™ã€‚ 123&gt; DOMString getAllResponseHeaders();`&gt; `DOMString getResponseHeader(DOMString header);&gt; è¿™2ä¸ªæ–¹æ³•çœ‹èµ·æ¥ç®€å•ï¼Œä½†å´å¤„å¤„æ˜¯å‘å„¿ã€‚ ä½ æ˜¯å¦é‡åˆ°è¿‡ä¸‹é¢çš„å‘å„¿?â€”â€”åæ­£æˆ‘æ˜¯é‡åˆ°äº†ã€‚ã€‚ã€‚ ä½¿ç”¨getAllResponseHeaders()çœ‹åˆ°çš„æ‰€æœ‰response headerä¸å®é™…åœ¨æ§åˆ¶å° Network ä¸­çœ‹åˆ°çš„ response headerä¸ä¸€æ · ä½¿ç”¨getResponseHeader()è·å–æŸä¸ª header çš„å€¼æ—¶ï¼Œæµè§ˆå™¨æŠ›é”™Refused to get unsafe header &quot;XXX&quot; ç»è¿‡ä¸€ç•ªå¯»æ‰¾æœ€ç»ˆåœ¨ Stack Overflowæ‰¾åˆ°äº†ç­”æ¡ˆã€‚ åŸå› 1ï¼šW3Cçš„ xhr æ ‡å‡†ä¸­åšäº†é™åˆ¶ï¼Œè§„å®šå®¢æˆ·ç«¯æ— æ³•è·å– response ä¸­çš„ Set-Cookieã€Set-Cookie2è¿™2ä¸ªå­—æ®µï¼Œæ— è®ºæ˜¯åŒåŸŸè¿˜æ˜¯è·¨åŸŸè¯·æ±‚ï¼› åŸå› 2ï¼šW3C çš„ cors æ ‡å‡†å¯¹äºè·¨åŸŸè¯·æ±‚ä¹Ÿåšäº†é™åˆ¶ï¼Œè§„å®šå¯¹äºè·¨åŸŸè¯·æ±‚ï¼Œå®¢æˆ·ç«¯å…è®¸è·å–çš„response headerå­—æ®µåªé™äºâ€œsimple response headerâ€å’Œâ€œAccess-Control-Expose-Headersâ€ ï¼ˆä¸¤ä¸ªåè¯çš„è§£é‡Šè§ä¸‹æ–¹ï¼‰ã€‚ â€œsimple response headerâ€œåŒ…æ‹¬çš„ header å­—æ®µæœ‰ï¼šCache-Control,Content-Language,Content-Type,Expires,Last-Modified,Pragma;â€œAccess-Control-Expose-Headersâ€œï¼šé¦–å…ˆå¾—æ³¨æ„æ˜¯â€Access-Control-Expose-Headersâ€œè¿›è¡Œè·¨åŸŸè¯·æ±‚æ—¶å“åº”å¤´éƒ¨ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œå¯¹äºåŒåŸŸè¯·æ±‚ï¼Œå“åº”å¤´éƒ¨æ˜¯æ²¡æœ‰è¿™ä¸ªå­—æ®µçš„ã€‚è¿™ä¸ªå­—æ®µä¸­åˆ—ä¸¾çš„ header å­—æ®µå°±æ˜¯æœåŠ¡å™¨å…è®¸æš´éœ²ç»™å®¢æˆ·ç«¯è®¿é—®çš„å­—æ®µã€‚ æ‰€ä»¥getAllResponseHeaders()åªèƒ½æ‹¿åˆ°é™åˆ¶ä»¥å¤–ï¼ˆå³è¢«è§†ä¸ºsafeï¼‰çš„headerå­—æ®µï¼Œè€Œä¸æ˜¯å…¨éƒ¨å­—æ®µï¼›è€Œè°ƒç”¨getResponseHeader(header)æ–¹æ³•æ—¶ï¼Œheaderå‚æ•°å¿…é¡»æ˜¯é™åˆ¶ä»¥å¤–çš„headerå­—æ®µï¼Œå¦åˆ™è°ƒç”¨å°±ä¼šæŠ¥Refused to get unsafe headerçš„é”™è¯¯ã€‚ å¦‚ä½•æŒ‡å®šxhr.responseçš„æ•°æ®ç±»å‹æœ‰äº›æ—¶å€™æˆ‘ä»¬å¸Œæœ›xhr.responseè¿”å›çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ç±»å‹ã€‚æ¯”å¦‚ï¼šå“åº”è¿”å›çš„æ•°æ®æ˜¯çº¯JSONå­—ç¬¦ä¸²ï¼Œä½†æˆ‘ä»¬æœŸæœ›æœ€ç»ˆé€šè¿‡xhr.responseæ‹¿åˆ°çš„ç›´æ¥å°±æ˜¯ä¸€ä¸ª js å¯¹è±¡ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿæœ‰2ç§æ–¹æ³•å¯ä»¥å®ç°ï¼Œä¸€ä¸ªæ˜¯level 1å°±æä¾›çš„overrideMimeType()æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯level 2æ‰æä¾›çš„xhr.responseTypeå±æ€§ã€‚ xhr.overrideMimeType()overrideMimeTypeæ˜¯xhr level 1å°±æœ‰çš„æ–¹æ³•ï¼Œæ‰€ä»¥æµè§ˆå™¨å…¼å®¹æ€§è‰¯å¥½ã€‚è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯ç”¨æ¥é‡å†™responseçš„content-typeï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿæ¯”å¦‚ï¼šserver ç«¯ç»™å®¢æˆ·ç«¯è¿”å›äº†ä¸€ä»½documentæˆ–è€…æ˜¯ xmlæ–‡æ¡£ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€ç»ˆé€šè¿‡xhr.responseæ‹¿åˆ°çš„å°±æ˜¯ä¸€ä¸ªDOMå¯¹è±¡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨xhr.overrideMimeType('text/xml; charset = utf-8')æ¥å®ç°ã€‚ å†ä¸¾ä¸€ä¸ªä½¿ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“xhr level 1ä¸æ”¯æŒç›´æ¥ä¼ è¾“blobäºŒè¿›åˆ¶æ•°æ®ï¼Œé‚£å¦‚æœçœŸè¦ä¼ è¾“ blob è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå½“æ—¶å°±æ˜¯åˆ©ç”¨overrideMimeTypeæ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªè·å–å›¾ç‰‡æ–‡ä»¶çš„ä»£ç ç¤ºä¾‹ï¼š 12345678910111213141516171819202122var xhr = new XMLHttpRequest();//å‘ server ç«¯è·å–ä¸€å¼ å›¾ç‰‡xhr.open(&apos;GET&apos;, &apos;/path/to/image.png&apos;, true);// è¿™è¡Œæ˜¯å…³é”®ï¼//å°†å“åº”æ•°æ®æŒ‰ç…§çº¯æ–‡æœ¬æ ¼å¼æ¥è§£æï¼Œå­—ç¬¦é›†æ›¿æ¢ä¸ºç”¨æˆ·è‡ªå·±å®šä¹‰çš„å­—ç¬¦é›†xhr.overrideMimeType(&apos;text/plain; charset=x-user-defined&apos;);xhr.onreadystatechange = function(e) { if (this.readyState == 4 &amp;&amp; this.status == 200) { //é€šè¿‡ responseText æ¥è·å–å›¾ç‰‡æ–‡ä»¶å¯¹åº”çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸² var binStr = this.responseText; //ç„¶åè‡ªå·±å†æƒ³æ–¹æ³•å°†é€ä¸ªå­—èŠ‚è¿˜åŸä¸ºäºŒè¿›åˆ¶æ•°æ® for (var i = 0, len = binStr.length; i &lt; len; ++i) { var c = binStr.charCodeAt(i); //String.fromCharCode(c &amp; 0xff); var byte = c &amp; 0xff; } }};xhr.send(); ä»£ç ç¤ºä¾‹ä¸­xhrè¯·æ±‚çš„æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œé€šè¿‡å°† response çš„ content-type æ”¹ä¸ºâ€™text/plain; charset=x-user-definedâ€™ï¼Œä½¿å¾— xhr ä»¥çº¯æ–‡æœ¬æ ¼å¼æ¥è§£ææ¥æ”¶åˆ°çš„blob æ•°æ®ï¼Œæœ€ç»ˆç”¨æˆ·é€šè¿‡this.responseTextæ‹¿åˆ°çš„å°±æ˜¯å›¾ç‰‡æ–‡ä»¶å¯¹åº”çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæœ€åå†å°†å…¶è½¬æ¢ä¸º blob æ•°æ®ã€‚ xhr.responseTyperesponseTypeæ˜¯xhr level 2æ–°å¢çš„å±æ€§ï¼Œç”¨æ¥æŒ‡å®šxhr.responseçš„æ•°æ®ç±»å‹ï¼Œç›®å‰è¿˜å­˜åœ¨äº›å…¼å®¹æ€§é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒæœ¬æ–‡çš„ã€XMLHttpRequestçš„å…¼å®¹æ€§ã€‘è¿™ä¸€å°èŠ‚ã€‚é‚£ä¹ˆresponseTypeå¯ä»¥è®¾ç½®ä¸ºå“ªäº›æ ¼å¼å‘¢ï¼Œæˆ‘ç®€å•åšäº†ä¸€ä¸ªè¡¨ï¼Œå¦‚ä¸‹ï¼š å€¼ xhr.response æ•°æ®ç±»å‹ è¯´æ˜ &quot;&quot; Stringå­—ç¬¦ä¸² é»˜è®¤å€¼(åœ¨ä¸è®¾ç½®responseTypeæ—¶) &quot;text&quot; Stringå­—ç¬¦ä¸² &quot;document&quot; Documentå¯¹è±¡ å¸Œæœ›è¿”å› XML æ ¼å¼æ•°æ®æ—¶ä½¿ç”¨ &quot;json&quot; javascript å¯¹è±¡ å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ï¼ŒIE10/IE11ä¸æ”¯æŒ &quot;blob&quot; Blobå¯¹è±¡ &quot;arrayBuffer&quot; ArrayBufferå¯¹è±¡ ä¸‹é¢æ˜¯åŒæ ·æ˜¯è·å–ä¸€å¼ å›¾ç‰‡çš„ä»£ç ç¤ºä¾‹ï¼Œç›¸æ¯”xhr.overrideMimeType,ç”¨xhr.responseæ¥å®ç°ç®€å•å¾—å¤šã€‚ 1234567891011121314var xhr = new XMLHttpRequest();xhr.open(&apos;GET&apos;, &apos;/path/to/image.png&apos;, true);//å¯ä»¥å°†`xhr.responseType`è®¾ç½®ä¸º`&quot;blob&quot;`ä¹Ÿå¯ä»¥è®¾ç½®ä¸º`&quot; arrayBuffer&quot;`//xhr.responseType = &apos;arrayBuffer&apos;;xhr.responseType = &apos;blob&apos;;xhr.onload = function(e) { if (this.status == 200) { var blob = this.response; ... }};xhr.send(); å°ç»“è™½ç„¶åœ¨xhr level 2ä¸­ï¼Œ2è€…æ˜¯å…±åŒå­˜åœ¨çš„ã€‚ä½†å…¶å®ä¸éš¾å‘ç°ï¼Œxhr.responseTypeå°±æ˜¯ç”¨æ¥å–ä»£xhr.overrideMimeType()çš„ï¼Œxhr.responseTypeåŠŸèƒ½å¼ºå¤§çš„å¤šï¼Œxhr.overrideMimeType()èƒ½åšåˆ°çš„xhr.responseTypeéƒ½èƒ½åšåˆ°ã€‚æ‰€ä»¥æˆ‘ä»¬ç°åœ¨å®Œå…¨å¯ä»¥æ‘’å¼ƒä½¿ç”¨xhr.overrideMimeType()äº†ã€‚ å¦‚ä½•è·å–responseæ•°æ®1xhr`æä¾›äº†3ä¸ªå±æ€§æ¥è·å–è¯·æ±‚è¿”å›çš„æ•°æ®ï¼Œåˆ†åˆ«æ˜¯ï¼š`xhr.response`ã€`xhr.responseText`ã€`xhr.responseXML xhr.response é»˜è®¤å€¼ï¼šç©ºå­—ç¬¦ä¸²&quot;&quot; å½“è¯·æ±‚å®Œæˆæ—¶ï¼Œæ­¤å±æ€§æ‰æœ‰æ­£ç¡®çš„å€¼ è¯·æ±‚æœªå®Œæˆæ—¶ï¼Œæ­¤å±æ€§çš„å€¼å¯èƒ½æ˜¯&quot;&quot;æˆ–è€… nullï¼Œå…·ä½“ä¸ xhr.responseTypeæœ‰å…³ï¼šå½“responseTypeä¸º&quot;&quot;æˆ–&quot;text&quot;æ—¶ï¼Œå€¼ä¸º&quot;&quot;ï¼›responseTypeä¸ºå…¶ä»–å€¼æ—¶ï¼Œå€¼ä¸º null xhr.responseText é»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot; åªæœ‰å½“ responseType ä¸º&quot;text&quot;ã€&quot;&quot;æ—¶ï¼Œxhrå¯¹è±¡ä¸Šæ‰æœ‰æ­¤å±æ€§ï¼Œæ­¤æ—¶æ‰èƒ½è°ƒç”¨xhr.responseTextï¼Œå¦åˆ™æŠ›é”™ åªæœ‰å½“è¯·æ±‚æˆåŠŸæ—¶ï¼Œæ‰èƒ½æ‹¿åˆ°æ­£ç¡®å€¼ã€‚ä»¥ä¸‹2ç§æƒ…å†µä¸‹å€¼éƒ½ä¸ºç©ºå­—ç¬¦ä¸²&quot;&quot;ï¼šè¯·æ±‚æœªå®Œæˆã€è¯·æ±‚å¤±è´¥ xhr.responseXML é»˜è®¤å€¼ä¸º null åªæœ‰å½“ responseType ä¸º&quot;text&quot;ã€&quot;&quot;ã€&quot;document&quot;æ—¶ï¼Œxhrå¯¹è±¡ä¸Šæ‰æœ‰æ­¤å±æ€§ï¼Œæ­¤æ—¶æ‰èƒ½è°ƒç”¨xhr.responseXMLï¼Œå¦åˆ™æŠ›é”™ åªæœ‰å½“è¯·æ±‚æˆåŠŸä¸”è¿”å›æ•°æ®è¢«æ­£ç¡®è§£ææ—¶ï¼Œæ‰èƒ½æ‹¿åˆ°æ­£ç¡®å€¼ã€‚ä»¥ä¸‹3ç§æƒ…å†µä¸‹å€¼éƒ½ä¸ºnullï¼šè¯·æ±‚æœªå®Œæˆã€è¯·æ±‚å¤±è´¥ã€è¯·æ±‚æˆåŠŸä½†è¿”å›æ•°æ®æ— æ³•è¢«æ­£ç¡®è§£ææ—¶ å¦‚ä½•è¿½è¸ªajaxè¯·æ±‚çš„å½“å‰çŠ¶æ€åœ¨å‘ä¸€ä¸ªajaxè¯·æ±‚åï¼Œå¦‚æœæƒ³è¿½è¸ªè¯·æ±‚å½“å‰å¤„äºå“ªç§çŠ¶æ€ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ ç”¨xhr.readyStateè¿™ä¸ªå±æ€§å³å¯è¿½è¸ªåˆ°ã€‚è¿™ä¸ªå±æ€§æ˜¯åªè¯»å±æ€§ï¼Œæ€»å…±æœ‰5ç§å¯èƒ½å€¼ï¼Œåˆ†åˆ«å¯¹åº”xhrä¸åŒçš„ä¸åŒé˜¶æ®µã€‚æ¯æ¬¡xhr.readyStateçš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šè§¦å‘xhr.onreadystatechangeäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªäº‹ä»¶ä¸­è¿›è¡Œç›¸å…³çŠ¶æ€åˆ¤æ–­ã€‚ 123456789101112131415xhr.onreadystatechange = function () { switch(xhr.readyState){ case 1://OPENED //do something break; case 2://HEADERS_RECEIVED //do something break; case 3://LOADING //do something break; case 4://DONE //do something break; } å€¼ çŠ¶æ€ æè¿° 0 UNSENT (åˆå§‹çŠ¶æ€ï¼Œæœªæ‰“å¼€) æ­¤æ—¶xhrå¯¹è±¡è¢«æˆåŠŸæ„é€ ï¼Œopen()æ–¹æ³•è¿˜æœªè¢«è°ƒç”¨ 1 OPENED (å·²æ‰“å¼€ï¼Œæœªå‘é€) open()æ–¹æ³•å·²è¢«æˆåŠŸè°ƒç”¨ï¼Œsend()æ–¹æ³•è¿˜æœªè¢«è°ƒç”¨ã€‚æ³¨æ„ï¼šåªæœ‰xhrå¤„äºOPENEDçŠ¶æ€ï¼Œæ‰èƒ½è°ƒç”¨xhr.setRequestHeader()å’Œxhr.send(),å¦åˆ™ä¼šæŠ¥é”™ 2 HEADERS_RECEIVED(å·²è·å–å“åº”å¤´) send()æ–¹æ³•å·²ç»è¢«è°ƒç”¨, å“åº”å¤´å’Œå“åº”çŠ¶æ€å·²ç»è¿”å› 3 LOADING (æ­£åœ¨ä¸‹è½½å“åº”ä½“) å“åº”ä½“(response entity body)æ­£åœ¨ä¸‹è½½ä¸­ï¼Œæ­¤çŠ¶æ€ä¸‹é€šè¿‡xhr.responseå¯èƒ½å·²ç»æœ‰äº†å“åº”æ•°æ® 4 DONE (æ•´ä¸ªæ•°æ®ä¼ è¾“è¿‡ç¨‹ç»“æŸ) æ•´ä¸ªæ•°æ®ä¼ è¾“è¿‡ç¨‹ç»“æŸï¼Œä¸ç®¡æœ¬æ¬¡è¯·æ±‚æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ å¦‚ä½•è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´å¦‚æœè¯·æ±‚è¿‡äº†å¾ˆä¹…è¿˜æ²¡æœ‰æˆåŠŸï¼Œä¸ºäº†ä¸ä¼šç™½ç™½å ç”¨çš„ç½‘ç»œèµ„æºï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä¸»åŠ¨ç»ˆæ­¢è¯·æ±‚ã€‚XMLHttpRequestæä¾›äº†timeoutå±æ€§æ¥å…è®¸è®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ã€‚ 12&gt; xhr.timeout&gt; å•ä½ï¼šmilliseconds æ¯«ç§’é»˜è®¤å€¼ï¼š0ï¼Œå³ä¸è®¾ç½®è¶…æ—¶ å¾ˆå¤šåŒå­¦éƒ½çŸ¥é“ï¼šä»è¯·æ±‚å¼€å§‹ ç®—èµ·ï¼Œè‹¥è¶…è¿‡ timeout æ—¶é—´è¯·æ±‚è¿˜æ²¡æœ‰ç»“æŸï¼ˆåŒ…æ‹¬æˆåŠŸ/å¤±è´¥ï¼‰ï¼Œåˆ™ä¼šè§¦å‘ontimeoutäº‹ä»¶ï¼Œä¸»åŠ¨ç»“æŸè¯¥è¯·æ±‚ã€‚ ã€é‚£ä¹ˆåˆ°åº•ä»€ä¹ˆæ—¶å€™æ‰ç®—æ˜¯è¯·æ±‚å¼€å§‹ ï¼Ÿã€‘â€”â€”xhr.onloadstartäº‹ä»¶è§¦å‘çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ä½ è°ƒç”¨xhr.send()æ–¹æ³•çš„æ—¶å€™ã€‚å› ä¸ºxhr.open()åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªè¿æ¥ï¼Œä½†å¹¶æ²¡æœ‰çœŸæ­£å¼€å§‹æ•°æ®çš„ä¼ è¾“ï¼Œè€Œxhr.send()æ‰æ˜¯çœŸæ­£å¼€å§‹äº†æ•°æ®çš„ä¼ è¾“è¿‡ç¨‹ã€‚åªæœ‰è°ƒç”¨äº†xhr.send()ï¼Œæ‰ä¼šè§¦å‘xhr.onloadstart ã€‚ ã€é‚£ä¹ˆä»€ä¹ˆæ—¶å€™æ‰ç®—æ˜¯è¯·æ±‚ç»“æŸ ï¼Ÿã€‘â€”â€” xhr.loadendäº‹ä»¶è§¦å‘çš„æ—¶å€™ã€‚ å¦å¤–ï¼Œè¿˜æœ‰2ä¸ªéœ€è¦æ³¨æ„çš„å‘å„¿ï¼š å¯ä»¥åœ¨ send()ä¹‹åå†è®¾ç½®æ­¤xhr.timeoutï¼Œä½†è®¡æ—¶èµ·å§‹ç‚¹ä»ä¸ºè°ƒç”¨xhr.send()æ–¹æ³•çš„æ—¶åˆ»ã€‚ å½“xhrä¸ºä¸€ä¸ªsyncåŒæ­¥è¯·æ±‚æ—¶ï¼Œxhr.timeoutå¿…é¡»ç½®ä¸º0ï¼Œå¦åˆ™ä¼šæŠ›é”™ã€‚åŸå› å¯ä»¥å‚è€ƒæœ¬æ–‡çš„ã€å¦‚ä½•å‘ä¸€ä¸ªåŒæ­¥è¯·æ±‚ã€‘ä¸€èŠ‚ã€‚ å¦‚ä½•å‘ä¸€ä¸ªåŒæ­¥è¯·æ±‚xhré»˜è®¤å‘çš„æ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œä½†ä¹Ÿæ”¯æŒå‘åŒæ­¥è¯·æ±‚ï¼ˆå½“ç„¶å®é™…å¼€å‘ä¸­åº”è¯¥å°½é‡é¿å…ä½¿ç”¨ï¼‰ã€‚åˆ°åº•æ˜¯å¼‚æ­¥è¿˜æ˜¯åŒæ­¥è¯·æ±‚ï¼Œç”±xhr.openï¼ˆï¼‰ä¼ å…¥çš„asyncå‚æ•°å†³å®šã€‚ 12&gt; open(method, url [, async = true [, username = null [, password = null]]])&gt; method: è¯·æ±‚çš„æ–¹å¼ï¼Œå¦‚GET/POST/HEADERç­‰ï¼Œè¿™ä¸ªå‚æ•°ä¸åŒºåˆ†å¤§å°å†™ url: è¯·æ±‚çš„åœ°å€ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹åœ°å€å¦‚example.phpï¼Œè¿™ä¸ªç›¸å¯¹æ˜¯ç›¸å¯¹äºå½“å‰ç½‘é¡µçš„urlè·¯å¾„ï¼›ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹åœ°å€å¦‚http://www.example.com/example.php async: é»˜è®¤å€¼ä¸ºtrueï¼Œå³ä¸ºå¼‚æ­¥è¯·æ±‚ï¼Œè‹¥async=falseï¼Œåˆ™ä¸ºåŒæ­¥è¯·æ±‚ åœ¨æˆ‘è®¤çœŸç ”è¯»W3C çš„ xhr æ ‡å‡†å‰ï¼Œæˆ‘æ€»ä»¥ä¸ºåŒæ­¥è¯·æ±‚å’Œå¼‚æ­¥è¯·æ±‚åªæ˜¯é˜»å¡å’Œéé˜»å¡çš„åŒºåˆ«ï¼Œå…¶ä»–ä»€ä¹ˆäº‹ä»¶è§¦å‘ã€å‚æ•°è®¾ç½®åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œäº‹å®è¯æ˜æˆ‘é”™äº†ã€‚ W3C çš„ xhræ ‡å‡†ä¸­å…³äºopen()æ–¹æ³•æœ‰è¿™æ ·ä¸€æ®µè¯´æ˜ï¼š Throws an â€œInvalidAccessErrorâ€ exception if async is false, the JavaScript global environment is a document environment, and either the timeout attribute is not zero, the withCredentials attribute is true, or the responseType attribute is not the empty string. ä»ä¸Šé¢ä¸€æ®µè¯´æ˜å¯ä»¥çŸ¥é“ï¼Œå½“xhrä¸ºåŒæ­¥è¯·æ±‚æ—¶ï¼Œæœ‰å¦‚ä¸‹é™åˆ¶ï¼š xhr.timeoutå¿…é¡»ä¸º0 xhr.withCredentialså¿…é¡»ä¸º false xhr.responseTypeå¿…é¡»ä¸º&quot;&quot;ï¼ˆæ³¨æ„ç½®ä¸º&quot;text&quot;ä¹Ÿä¸å…è®¸ï¼‰ è‹¥ä¸Šé¢ä»»ä½•ä¸€ä¸ªé™åˆ¶ä¸æ»¡è¶³ï¼Œéƒ½ä¼šæŠ›é”™ï¼Œè€Œå¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œåˆ™æ²¡æœ‰è¿™äº›å‚æ•°è®¾ç½®ä¸Šçš„é™åˆ¶ã€‚ ä¹‹å‰è¯´è¿‡é¡µé¢ä¸­åº”è¯¥å°½é‡é¿å…ä½¿ç”¨syncåŒæ­¥è¯·æ±‚ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æ— æ³•è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆxhr.timeoutä¸º0ï¼Œå³ä¸é™æ—¶ï¼‰ã€‚åœ¨ä¸é™åˆ¶è¶…æ—¶çš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½åŒæ­¥è¯·æ±‚ä¸€ç›´å¤„äºpendingçŠ¶æ€ï¼ŒæœåŠ¡ç«¯è¿Ÿè¿Ÿä¸è¿”å›å“åº”ï¼Œè¿™æ ·æ•´ä¸ªé¡µé¢å°±ä¼šä¸€ç›´é˜»å¡ï¼Œæ— æ³•å“åº”ç”¨æˆ·çš„å…¶ä»–äº¤äº’ã€‚ å¦å¤–ï¼Œæ ‡å‡†ä¸­å¹¶æ²¡æœ‰æåŠåŒæ­¥è¯·æ±‚æ—¶äº‹ä»¶è§¦å‘çš„é™åˆ¶ï¼Œä½†å®é™…å¼€å‘ä¸­æˆ‘ç¡®å®é‡åˆ°è¿‡éƒ¨åˆ†åº”è¯¥è§¦å‘çš„äº‹ä»¶å¹¶æ²¡æœ‰è§¦å‘çš„ç°è±¡ã€‚å¦‚åœ¨ chromeä¸­ï¼Œå½“xhrä¸ºåŒæ­¥è¯·æ±‚æ—¶ï¼Œåœ¨xhr.readyStateç”±2å˜æˆ3æ—¶ï¼Œå¹¶ä¸ä¼šè§¦å‘ onreadystatechangeäº‹ä»¶ï¼Œxhr.upload.onprogresså’Œ xhr.onprogressäº‹ä»¶ä¹Ÿä¸ä¼šè§¦å‘ã€‚ å¦‚ä½•è·å–ä¸Šä¼ ã€ä¸‹è½½çš„è¿›åº¦åœ¨ä¸Šä¼ æˆ–è€…ä¸‹è½½æ¯”è¾ƒå¤§çš„æ–‡ä»¶æ—¶ï¼Œå®æ—¶æ˜¾ç¤ºå½“å‰çš„ä¸Šä¼ ã€ä¸‹è½½è¿›åº¦æ˜¯å¾ˆæ™®éçš„äº§å“éœ€æ±‚ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡onprogressäº‹ä»¶æ¥å®æ—¶æ˜¾ç¤ºè¿›åº¦ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿™ä¸ªäº‹ä»¶æ¯50msè§¦å‘ä¸€æ¬¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šä¼ è¿‡ç¨‹å’Œä¸‹è½½è¿‡ç¨‹è§¦å‘çš„æ˜¯ä¸åŒå¯¹è±¡çš„onprogressäº‹ä»¶ï¼š ä¸Šä¼ è§¦å‘çš„æ˜¯xhr.uploadå¯¹è±¡çš„ onprogressäº‹ä»¶ ä¸‹è½½è§¦å‘çš„æ˜¯xhrå¯¹è±¡çš„onprogressäº‹ä»¶ 1234567xhr.onprogress = updateProgress;xhr.upload.onprogress = updateProgress;function updateProgress(event) { if (event.lengthComputable) { var completedPercent = event.loaded / event.total; } } å¯ä»¥å‘é€ä»€ä¹ˆç±»å‹çš„æ•°æ® void send(data); xhr.send(data)çš„å‚æ•°dataå¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š ArrayBuffer Blob Document DOMString FormData null å¦‚æœæ˜¯ GET/HEADè¯·æ±‚ï¼Œsend()æ–¹æ³•ä¸€èˆ¬ä¸ä¼ å‚æˆ–ä¼  nullã€‚ä¸è¿‡å³ä½¿ä½ çœŸä¼ å…¥äº†å‚æ•°ï¼Œå‚æ•°ä¹Ÿæœ€ç»ˆè¢«å¿½ç•¥ï¼Œxhr.send(data)ä¸­çš„dataä¼šè¢«ç½®ä¸º null. xhr.send(data)ä¸­dataå‚æ•°çš„æ•°æ®ç±»å‹ä¼šå½±å“è¯·æ±‚å¤´éƒ¨content-typeçš„é»˜è®¤å€¼ï¼š å¦‚æœdataæ˜¯ Document ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿæ˜¯HTML Documentç±»å‹ï¼Œåˆ™content-typeé»˜è®¤å€¼ä¸ºtext/html;charset=UTF-8;å¦åˆ™ä¸ºapplication/xml;charset=UTF-8ï¼› å¦‚æœdataæ˜¯ DOMString ç±»å‹ï¼Œcontent-typeé»˜è®¤å€¼ä¸ºtext/plain;charset=UTF-8ï¼› å¦‚æœdataæ˜¯ FormData ç±»å‹ï¼Œcontent-typeé»˜è®¤å€¼ä¸ºmultipart/form-data; boundary=[xxx] å¦‚æœdataæ˜¯å…¶ä»–ç±»å‹ï¼Œåˆ™ä¸ä¼šè®¾ç½®content-typeçš„é»˜è®¤å€¼ å½“ç„¶è¿™äº›åªæ˜¯content-typeçš„é»˜è®¤å€¼ï¼Œä½†å¦‚æœç”¨xhr.setRequestHeader()æ‰‹åŠ¨è®¾ç½®äº†ä¸­content-typeçš„å€¼ï¼Œä»¥ä¸Šé»˜è®¤å€¼å°±ä¼šè¢«è¦†ç›–ã€‚ å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥åœ¨æ–­ç½‘çŠ¶æ€ä¸‹è°ƒç”¨xhr.send(data)æ–¹æ³•ï¼Œåˆ™ä¼šæŠ›é”™ï¼šUncaught NetworkError: Failed to execute 'send' on 'XMLHttpRequest'ã€‚ä¸€æ—¦ç¨‹åºæŠ›å‡ºé”™è¯¯ï¼Œå¦‚æœä¸ catch å°±æ— æ³•ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ï¼Œæ‰€ä»¥è°ƒç”¨ xhr.send(data)æ–¹æ³•æ—¶ï¼Œåº”è¯¥ç”¨ try-catchæ•æ‰é”™è¯¯ã€‚ 12345try{ xhr.send(data) }catch(e) { //doSomething... }; xhr.withCredentialsä¸ CORS ä»€ä¹ˆå…³ç³» æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨å‘åŒåŸŸè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†cookieè‡ªåŠ¨åŠ åœ¨request headerä¸­ã€‚ä½†å¤§å®¶æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼šåœ¨å‘é€è·¨åŸŸè¯·æ±‚æ—¶ï¼Œcookieå¹¶æ²¡æœ‰è‡ªåŠ¨åŠ åœ¨request headerä¸­ã€‚ é€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ï¼šåœ¨CORSæ ‡å‡†ä¸­åšäº†è§„å®šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨åœ¨å‘é€è·¨åŸŸè¯·æ±‚æ—¶ï¼Œä¸èƒ½å‘é€ä»»ä½•è®¤è¯ä¿¡æ¯ï¼ˆcredentialsï¼‰å¦‚â€cookiesâ€œå’Œâ€HTTP authentication schemesâ€œã€‚é™¤éxhr.withCredentialsä¸ºtrueï¼ˆxhrå¯¹è±¡æœ‰ä¸€ä¸ªå±æ€§å«withCredentialsï¼Œé»˜è®¤å€¼ä¸ºfalseï¼‰ã€‚ æ‰€ä»¥æ ¹æœ¬åŸå› æ˜¯cookiesä¹Ÿæ˜¯ä¸€ç§è®¤è¯ä¿¡æ¯ï¼Œåœ¨è·¨åŸŸè¯·æ±‚ä¸­ï¼Œclientç«¯å¿…é¡»æ‰‹åŠ¨è®¾ç½®xhr.withCredentials=trueï¼Œä¸”serverç«¯ä¹Ÿå¿…é¡»å…è®¸requestèƒ½æºå¸¦è®¤è¯ä¿¡æ¯ï¼ˆå³response headerä¸­åŒ…å«Access-Control-Allow-Credentials:trueï¼‰ï¼Œè¿™æ ·æµè§ˆå™¨æ‰ä¼šè‡ªåŠ¨å°†cookieåŠ åœ¨request headerä¸­ã€‚ å¦å¤–ï¼Œè¦ç‰¹åˆ«æ³¨æ„ä¸€ç‚¹ï¼Œä¸€æ—¦è·¨åŸŸrequestèƒ½å¤Ÿæºå¸¦è®¤è¯ä¿¡æ¯ï¼Œserverç«¯ä¸€å®šä¸èƒ½å°†Access-Control-Allow-Originè®¾ç½®ä¸º*ï¼Œè€Œå¿…é¡»è®¾ç½®ä¸ºè¯·æ±‚é¡µé¢çš„åŸŸåã€‚ xhrç›¸å…³äº‹ä»¶äº‹ä»¶åˆ†ç±»xhrç›¸å…³äº‹ä»¶æœ‰å¾ˆå¤šï¼Œæœ‰æ—¶è®°èµ·æ¥è¿˜æŒºå®¹æ˜“æ··ä¹±ã€‚ä½†å½“æˆ‘äº†è§£äº†å…·ä½“ä»£ç å®ç°åï¼Œå°±å®¹æ˜“ç†æ¸…æ¥šäº†ã€‚ä¸‹é¢æ˜¯XMLHttpRequestçš„éƒ¨åˆ†å®ç°ä»£ç ï¼š 1234567891011121314151617181920interface XMLHttpRequestEventTarget : EventTarget { // event handlers attribute EventHandler onloadstart; attribute EventHandler onprogress; attribute EventHandler onabort; attribute EventHandler onerror; attribute EventHandler onload; attribute EventHandler ontimeout; attribute EventHandler onloadend;};interface XMLHttpRequestUpload : XMLHttpRequestEventTarget {};interface XMLHttpRequest : XMLHttpRequestEventTarget { // event handler attribute EventHandler onreadystatechange; readonly attribute XMLHttpRequestUpload upload;}; ä»ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼š XMLHttpRequestEventTargetæ¥å£å®šä¹‰äº†7ä¸ªäº‹ä»¶ï¼š onloadstart onprogress onabort ontimeout onerror onload onloadend æ¯ä¸€ä¸ªXMLHttpRequesté‡Œé¢éƒ½æœ‰ä¸€ä¸ªuploadå±æ€§ï¼Œè€Œuploadæ˜¯ä¸€ä¸ªXMLHttpRequestUploadå¯¹è±¡ XMLHttpRequestå’ŒXMLHttpRequestUploadéƒ½ç»§æ‰¿äº†åŒä¸€ä¸ªXMLHttpRequestEventTargetæ¥å£ï¼Œæ‰€ä»¥xhrå’Œxhr.uploadéƒ½æœ‰ç¬¬ä¸€æ¡åˆ—ä¸¾çš„7ä¸ªäº‹ä»¶ onreadystatechangeæ˜¯XMLHttpRequestç‹¬æœ‰çš„äº‹ä»¶ æ‰€ä»¥è¿™ä¹ˆä¸€çœ‹å°±å¾ˆæ¸…æ™°äº†ï¼šxhrä¸€å…±æœ‰8ä¸ªç›¸å…³äº‹ä»¶ï¼š7ä¸ªXMLHttpRequestEventTargetäº‹ä»¶+1ä¸ªç‹¬æœ‰çš„onreadystatechangeäº‹ä»¶ï¼›è€Œxhr.uploadåªæœ‰7ä¸ªXMLHttpRequestEventTargetäº‹ä»¶ã€‚ äº‹ä»¶è§¦å‘æ¡ä»¶ä¸‹é¢æ˜¯æˆ‘è‡ªå·±æ•´ç†çš„ä¸€å¼ xhrç›¸å…³äº‹ä»¶è§¦å‘æ¡ä»¶è¡¨ï¼Œå…¶ä¸­æœ€éœ€è¦æ³¨æ„çš„æ˜¯ onerror äº‹ä»¶çš„è§¦å‘æ¡ä»¶ã€‚ äº‹ä»¶ è§¦å‘æ¡ä»¶ onreadystatechange æ¯å½“xhr.readyStateæ”¹å˜æ—¶è§¦å‘ï¼›ä½†xhr.readyStateç”±é0å€¼å˜ä¸º0æ—¶ä¸è§¦å‘ã€‚ onloadstart è°ƒç”¨xhr.send()æ–¹æ³•åç«‹å³è§¦å‘ï¼Œè‹¥xhr.send()æœªè¢«è°ƒç”¨åˆ™ä¸ä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚ onprogress xhr.upload.onprogressåœ¨ä¸Šä¼ é˜¶æ®µ(å³xhr.send()ä¹‹åï¼Œxhr.readystate=2ä¹‹å‰)è§¦å‘ï¼Œæ¯50msè§¦å‘ä¸€æ¬¡ï¼›xhr.onprogressåœ¨ä¸‹è½½é˜¶æ®µï¼ˆå³xhr.readystate=3æ—¶ï¼‰è§¦å‘ï¼Œæ¯50msè§¦å‘ä¸€æ¬¡ã€‚ onload å½“è¯·æ±‚æˆåŠŸå®Œæˆæ—¶è§¦å‘ï¼Œæ­¤æ—¶xhr.readystate=4 onloadend å½“è¯·æ±‚ç»“æŸï¼ˆåŒ…æ‹¬è¯·æ±‚æˆåŠŸå’Œè¯·æ±‚å¤±è´¥ï¼‰æ—¶è§¦å‘ onabort å½“è°ƒç”¨xhr.abort()åè§¦å‘ ontimeout xhr.timeoutä¸ç­‰äº0ï¼Œç”±è¯·æ±‚å¼€å§‹å³onloadstartå¼€å§‹ç®—èµ·ï¼Œå½“åˆ°è¾¾xhr.timeoutæ‰€è®¾ç½®æ—¶é—´è¯·æ±‚è¿˜æœªç»“æŸå³onloadendï¼Œåˆ™è§¦å‘æ­¤äº‹ä»¶ã€‚ onerror åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œè‹¥å‘ç”ŸNetwork erroråˆ™ä¼šè§¦å‘æ­¤äº‹ä»¶ï¼ˆè‹¥å‘ç”ŸNetwork erroræ—¶ï¼Œä¸Šä¼ è¿˜æ²¡æœ‰ç»“æŸï¼Œåˆ™ä¼šå…ˆè§¦å‘xhr.upload.onerrorï¼Œå†è§¦å‘xhr.onerrorï¼›è‹¥å‘ç”ŸNetwork erroræ—¶ï¼Œä¸Šä¼ å·²ç»ç»“æŸï¼Œåˆ™åªä¼šè§¦å‘xhr.onerrorï¼‰ã€‚æ³¨æ„ï¼Œåªæœ‰å‘ç”Ÿäº†ç½‘ç»œå±‚çº§åˆ«çš„å¼‚å¸¸æ‰ä¼šè§¦å‘æ­¤äº‹ä»¶ï¼Œå¯¹äºåº”ç”¨å±‚çº§åˆ«çš„å¼‚å¸¸ï¼Œå¦‚å“åº”è¿”å›çš„xhr.statusCodeæ˜¯4xxæ—¶ï¼Œå¹¶ä¸å±äºNetwork errorï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘onerroräº‹ä»¶ï¼Œè€Œæ˜¯ä¼šè§¦å‘onloadäº‹ä»¶ã€‚ äº‹ä»¶è§¦å‘é¡ºåºå½“è¯·æ±‚ä¸€åˆ‡æ­£å¸¸æ—¶ï¼Œç›¸å…³çš„äº‹ä»¶è§¦å‘é¡ºåºå¦‚ä¸‹ï¼š è§¦å‘xhr.onreadystatechange(ä¹‹åæ¯æ¬¡readyStateå˜åŒ–æ—¶ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡) è§¦å‘xhr.onloadstart//ä¸Šä¼ é˜¶æ®µå¼€å§‹ï¼š è§¦å‘xhr.upload.onloadstart è§¦å‘xhr.upload.onprogress è§¦å‘xhr.upload.onload è§¦å‘xhr.upload.onloadend//ä¸Šä¼ ç»“æŸï¼Œä¸‹è½½é˜¶æ®µå¼€å§‹ï¼š è§¦å‘xhr.onprogress è§¦å‘xhr.onload è§¦å‘xhr.onloadend å‘ç”Ÿabort/timeout/errorå¼‚å¸¸çš„å¤„ç†åœ¨è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½å‘ç”Ÿ abort/timeout/errorè¿™3ç§å¼‚å¸¸ã€‚é‚£ä¹ˆä¸€æ—¦å‘ç”Ÿè¿™äº›å¼‚å¸¸ï¼Œxhråç»­ä¼šè¿›è¡Œå“ªäº›å¤„ç†å‘¢ï¼Ÿåç»­å¤„ç†å¦‚ä¸‹ï¼š ä¸€æ—¦å‘ç”Ÿabortæˆ–timeoutæˆ–errorå¼‚å¸¸ï¼Œå…ˆç«‹å³ä¸­æ­¢å½“å‰è¯·æ±‚ å°† readystate ç½®ä¸º4ï¼Œå¹¶è§¦å‘ xhr.onreadystatechangeäº‹ä»¶ å¦‚æœä¸Šä¼ é˜¶æ®µè¿˜æ²¡æœ‰ç»“æŸï¼Œåˆ™ä¾æ¬¡è§¦å‘ä»¥ä¸‹äº‹ä»¶ï¼š xhr.upload.onprogress xhr.upload.[onabortæˆ–ontimeoutæˆ–onerror] xhr.upload.onloadend è§¦å‘ xhr.onprogressäº‹ä»¶ è§¦å‘ xhr.[onabortæˆ–ontimeoutæˆ–onerror]äº‹ä»¶ è§¦å‘xhr.onloadend äº‹ä»¶ åœ¨å“ªä¸ªxhräº‹ä»¶ä¸­æ³¨å†ŒæˆåŠŸå›è°ƒï¼Ÿä»ä¸Šé¢ä»‹ç»çš„äº‹ä»¶ä¸­ï¼Œå¯ä»¥çŸ¥é“è‹¥xhrè¯·æ±‚æˆåŠŸï¼Œå°±ä¼šè§¦å‘xhr.onreadystatechangeå’Œxhr.onloadä¸¤ä¸ªäº‹ä»¶ã€‚ é‚£ä¹ˆæˆ‘ä»¬åˆ°åº•è¦å°†æˆåŠŸå›è°ƒæ³¨å†Œåœ¨å“ªä¸ªäº‹ä»¶ä¸­å‘¢ï¼Ÿæˆ‘å€¾å‘äº xhr.onloadäº‹ä»¶ï¼Œå› ä¸ºxhr.onreadystatechangeæ˜¯æ¯æ¬¡xhr.readyStateå˜åŒ–æ—¶éƒ½ä¼šè§¦å‘ï¼Œè€Œä¸æ˜¯xhr.readyState=4æ—¶æ‰è§¦å‘ã€‚ 123456xhr.onload = function () { //å¦‚æœè¯·æ±‚æˆåŠŸ if(xhr.status == 200){ //do successCallback } } ä¸Šé¢çš„ç¤ºä¾‹ä»£ç æ˜¯å¾ˆå¸¸è§çš„å†™æ³•ï¼šå…ˆåˆ¤æ–­httpçŠ¶æ€ç æ˜¯å¦æ˜¯200ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è®¤ä¸ºè¯·æ±‚æ˜¯æˆåŠŸçš„ï¼Œæ¥ç€æ‰§è¡ŒæˆåŠŸå›è°ƒã€‚è¿™æ ·çš„åˆ¤æ–­æ˜¯æœ‰å‘å„¿çš„ï¼Œæ¯”å¦‚å½“è¿”å›çš„httpçŠ¶æ€ç ä¸æ˜¯200ï¼Œè€Œæ˜¯201æ—¶ï¼Œè¯·æ±‚è™½ç„¶ä¹Ÿæ˜¯æˆåŠŸçš„ï¼Œä½†å¹¶æ²¡æœ‰æ‰§è¡ŒæˆåŠŸå›è°ƒé€»è¾‘ã€‚æ‰€ä»¥æ›´é è°±çš„åˆ¤æ–­æ–¹æ³•åº”è¯¥æ˜¯ï¼šå½“httpçŠ¶æ€ç ä¸º2xxæˆ–304æ—¶æ‰è®¤ä¸ºæˆåŠŸã€‚ 123456xhr.onload = function () { //å¦‚æœè¯·æ±‚æˆåŠŸ if((xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304){ //do successCallback }} ç»“è¯­ç»ˆäºå†™å®Œäº†â€¦â€¦çœ‹å®Œé‚£ä¸€ç¯‡é•¿é•¿çš„W3Cçš„xhr æ ‡å‡†ï¼Œæˆ‘çœ¼ç›éƒ½èŠ±äº†â€¦â€¦å¸Œæœ›è¿™ç¯‡æ€»ç»“èƒ½å¸®åŠ©åˆšå¼€å§‹æ¥è§¦XMLHttpRequestçš„ä½ ã€‚ æœ€åç»™ç‚¹æ‰©å±•å­¦ä¹ èµ„æ–™ï¼Œå¦‚æœä½ ï¼š æƒ³çœŸæ­£ææ‡‚XMLHttpRequestï¼Œæœ€é è°±çš„æ–¹æ³•è¿˜æ˜¯çœ‹ W3Cçš„xhr æ ‡å‡†; æƒ³ç»“åˆä»£ç å­¦ä¹ å¦‚ä½•ç”¨XMLHttpRequestå‘å„ç§ç±»å‹çš„æ•°æ®ï¼Œå¯ä»¥å‚è€ƒhtml5rocksä¸Šçš„è¿™ç¯‡æ–‡ç«  æƒ³ç²—ç•¥çš„äº†è§£XMLHttpRequestçš„åŸºæœ¬ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒMDNçš„XMLHttpRequestä»‹ç»ï¼› æƒ³äº†è§£XMLHttpRequest çš„å‘å±•å†ç¨‹ï¼Œå¯ä»¥å‚è€ƒé˜®è€å¸ˆçš„æ–‡ç« ï¼› æƒ³äº†è§£Ajaxçš„åŸºæœ¬ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒAJAX Tutorial; æƒ³äº†è§£è·¨åŸŸè¯·æ±‚ï¼Œåˆ™å¯ä»¥å‚è€ƒW3Cçš„ cors æ ‡å‡†; æƒ³äº†è§£httpåè®®ï¼Œåˆ™å¯ä»¥å‚è€ƒHTTP Tutorial;","link":"/2019/07/09/Ajaxå’ŒXMLHttpRequest/"}],"tags":[{"name":"ReactNative","slug":"ReactNative","link":"/tags/ReactNative/"},{"name":"TypeScript","slug":"TypeScript","link":"/tags/TypeScript/"},{"name":"React","slug":"React","link":"/tags/React/"},{"name":"ç¯å¢ƒé…ç½®","slug":"ç¯å¢ƒé…ç½®","link":"/tags/ç¯å¢ƒé…ç½®/"},{"name":"async/await","slug":"async-await","link":"/tags/async-await/"},{"name":"ä¸Šæ‹‰åŠ è½½","slug":"ä¸Šæ‹‰åŠ è½½","link":"/tags/ä¸Šæ‹‰åŠ è½½/"},{"name":"HTTP","slug":"HTTP","link":"/tags/HTTP/"},{"name":"Axios","slug":"Axios","link":"/tags/Axios/"},{"name":"ç½‘é¡µé…è‰²","slug":"ç½‘é¡µé…è‰²","link":"/tags/ç½‘é¡µé…è‰²/"},{"name":"å¸ƒå±€","slug":"å¸ƒå±€","link":"/tags/å¸ƒå±€/"},{"name":"flex","slug":"flex","link":"/tags/flex/"},{"name":"absolute","slug":"absolute","link":"/tags/absolute/"},{"name":"table","slug":"table","link":"/tags/table/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/tags/æ•°æ®ç»“æ„/"},{"name":"æ’åº","slug":"æ’åº","link":"/tags/æ’åº/"},{"name":"Hook","slug":"Hook","link":"/tags/Hook/"},{"name":"Promise","slug":"Promise","link":"/tags/Promise/"},{"name":"CSS","slug":"CSS","link":"/tags/CSS/"},{"name":"Ajax","slug":"Ajax","link":"/tags/Ajax/"},{"name":"XMLHttpRequest","slug":"XMLHttpRequest","link":"/tags/XMLHttpRequest/"}],"categories":[{"name":"ReactNative","slug":"ReactNative","link":"/categories/ReactNative/"},{"name":"React","slug":"React","link":"/categories/React/"},{"name":"ES6","slug":"ES6","link":"/categories/ES6/"},{"name":"HTTP","slug":"HTTP","link":"/categories/HTTP/"},{"name":"CSS","slug":"CSS","link":"/categories/CSS/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","link":"/categories/æ•°æ®ç»“æ„/"}]}